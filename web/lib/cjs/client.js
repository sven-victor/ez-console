"use strict";var p=Object.defineProperty;var l=(t,e,r)=>e in t?p(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var c=(t,e,r)=>l(t,typeof e!="symbol"?e+"":e,r);const u=require("./base.js"),h=require("axios"),d="/api",s=h.create({baseURL:d,timeout:3e4,headers:{"Content-Type":"application/json"}});class a extends Error{constructor(r,o){super(o);c(this,"code");this.code=r}}s.interceptors.request.use(t=>{if(!t.withoutAuth){const r=localStorage.getItem("token");r&&(t.headers=t.headers||{},t.headers.Authorization=`Bearer ${r}`)}const e=localStorage.getItem("i18nextLng");return e&&(t.headers["Accept-Language"]=e),t},t=>Promise.reject(t));s.interceptors.response.use(t=>{const e=t.data;return e&&e.code!==void 0?e.code==="0"?e.total!==void 0&&e.current!==void 0&&e.page_size!==void 0?{data:e.data,total:e.total,current:e.current,page_size:e.page_size}:e.data:Promise.reject(e||"Unknown error"):t.data},t=>{var o,n,i;((o=t.response)==null?void 0:o.status)===401&&window.location.pathname!==u.getURL("/login")&&(localStorage.removeItem("token"),delete s.defaults.headers.common.Authorization,window.location.href=u.getURL("/login?redirect="+encodeURIComponent(window.location.href)));const e=(n=t.response)==null?void 0:n.data;let r=new a(((i=t.response)==null?void 0:i.status.toString())||"500",t.message);return console.log("errorResponse",e),e&&(e.err?r=new a(e.code,e.err):e.error&&(r=new a(e.code,e.error))),Promise.reject(r)});const m=async(t,e)=>s.get(t,e),g=async(t,e,r)=>s.post(t,e,r),w=async(t,e,r)=>s.put(t,e,r),q=async(t,e)=>s.delete(t,e),L=async(t,e)=>{const{requestType:r,...o}=e||{};return r==="form"?s.request({url:t,baseURL:"",...o,headers:{...e==null?void 0:e.headers,"Content-Type":"multipart/form-data"}}):s.request({url:t,baseURL:"",...o})};exports.ApiError=a;exports.apiDelete=q;exports.apiGet=m;exports.apiPost=g;exports.apiPut=w;exports.baseURL=d;exports.client=s;exports.request=L;
