"use strict";var d=Object.defineProperty;var p=(t,e,r)=>e in t?d(t,e,{enumerable:!0,configurable:!0,writable:!0,value:r}):t[e]=r;var c=(t,e,r)=>p(t,typeof e!="symbol"?e+"":e,r);const l=require("./vendor.js"),u="/api",o=l.axios.create({baseURL:u,timeout:3e4,headers:{"Content-Type":"application/json"}});class n extends Error{constructor(r,s){super(s);c(this,"code");this.code=r}}o.interceptors.request.use(t=>{if(!t.withoutAuth){const r=localStorage.getItem("token");r&&(t.headers=t.headers||{},t.headers.Authorization=`Bearer ${r}`)}const e=localStorage.getItem("i18nextLng");return e&&(t.headers["Accept-Language"]=e),t},t=>Promise.reject(t));o.interceptors.response.use(t=>{const e=t.data;return e&&e.code!==void 0?e.code==="0"?e.total!==void 0&&e.current!==void 0&&e.page_size!==void 0?{data:e.data,total:e.total,current:e.current,page_size:e.page_size}:e.data:Promise.reject(e||"Unknown error"):t.data},t=>{var s,a,i;((s=t.response)==null?void 0:s.status)===401&&window.location.pathname!=="/console/login"&&(localStorage.removeItem("token"),delete o.defaults.headers.common.Authorization,window.location.href="/console/login?redirect="+encodeURIComponent(window.location.href));const e=(a=t.response)==null?void 0:a.data;let r=new n(((i=t.response)==null?void 0:i.status.toString())||"500",t.message);return console.log("errorResponse",e),e&&(e.err?r=new n(e.code,e.err):e.error&&(r=new n(e.code,e.error))),Promise.reject(r)});const h=async(t,e)=>o.get(t,e),m=async(t,e,r)=>o.post(t,e,r),w=async(t,e,r)=>o.put(t,e,r),g=async(t,e)=>o.delete(t,e),q=async(t,e)=>{const{requestType:r,...s}=e||{};return r==="form"?o.request({url:t,baseURL:"",...s,headers:{...e==null?void 0:e.headers,"Content-Type":"multipart/form-data"}}):o.request({url:t,baseURL:"",...s})};exports.ApiError=n;exports.apiDelete=g;exports.apiGet=h;exports.apiPost=m;exports.apiPut=w;exports.baseURL=u;exports.client=o;exports.request=q;
