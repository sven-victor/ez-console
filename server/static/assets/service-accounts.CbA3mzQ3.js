import{u as F,F as v,e as U,r as d,j as e,M as Z,m as Y,aU as ue,E as b,n as r,s as f,ac as de,am as Se,a2 as N,aV as R,O as J,aW as ee,aX as ge,y as be,aN as H,aK as Q,V as ce,aO as ae,C as $,Y as te,Z as G,a0 as _e,aY as we,a1 as ie,aP as fe,X as he,aJ as se,T as ye,aZ as pe,a_ as ke,$ as Ee,x as Ce,a$ as Ie,b0 as Fe,b1 as Re,h as Te,W as X,_ as xe,c as Ke,al as De,b2 as Pe,S as oe,aM as me,b3 as D,b4 as ze,af as Ne}from"./vendor.Bo5zsZF4.js";import{f as I}from"./components.25Zlqver.js";import{G as Ue,H as $e,I as ve,P as B,J as Me,j as P,K as Ae,L as je,M as Le,N as Oe,O as Be,Q as qe,B as Je,R as Ge,S as We}from"./base.Dox78hP9.js";import Ze from"./not_found.GTNqQCqU.js";import{a as He}from"./contexts.CmYLKDr7.js";const Ve=({serviceAccountID:s,onClose:t,open:j=!1,onSuccess:_})=>{const{t:n}=F("authorization"),{t:a}=F("common"),[u]=v.useForm(),{run:p,loading:x}=U(m=>s?Ue(s,m):$e(m),{onSuccess:()=>{f.success(n("serviceAccount.saveSuccess",{defaultValue:"Service account saved successfully."})),t(),_==null||_()},onError:()=>{f.error(n("serviceAccount.saveError",{defaultValue:"Failed to save service account."}))},manual:!0});return d.useEffect(()=>{j&&s?ve(s).then(m=>{u.setFieldsValue({name:m.name,description:m.description})}):u.resetFields()},[s,j]),e.jsx(Z,{title:s?n("serviceAccount.edit",{defaultValue:"Edit Service Account"}):n("serviceAccount.create",{defaultValue:"Create Service Account"}),width:500,onClose:t,open:j,footer:e.jsxs(b,{children:[e.jsx(r,{onClick:t,children:a("cancel",{defaultValue:"Cancel"})}),e.jsx(r,{type:"primary",onClick:u.submit,loading:x,children:a("save",{defaultValue:"Save"})})]}),children:e.jsxs(v,{form:u,layout:"vertical",onFinish:p,children:[e.jsx(v.Item,{label:n("serviceAccount.name",{defaultValue:"Name"}),name:"name",rules:[{required:!0,message:n("serviceAccount.nameRequired",{defaultValue:"Please enter a name for the service account."})}],children:e.jsx(Y,{placeholder:n("serviceAccount.namePlaceholder",{defaultValue:"Enter service account name"})})}),e.jsx(v.Item,{label:n("serviceAccount.description",{defaultValue:"Description"}),name:"description",children:e.jsx(ue,{rows:4,placeholder:n("serviceAccount.descriptionPlaceholder",{defaultValue:"Enter service account description (optional)"})})})]})})},Qe=()=>{const{t:s}=F("authorization"),{t}=F("common"),j=de(),[_]=v.useForm(),[n]=v.useForm(),[a,u]=d.useState(!1),[p,x]=d.useState([]),[m,o]=d.useState(0),[C,V]=d.useState(!1),[w,S]=d.useState(null),[g,i]=d.useState({current:B.DEFAULT_CURRENT,page_size:B.DEFAULT_PAGE_SIZE,search:void 0}),h=d.useCallback(async()=>{try{u(!0);const c=await Me(g);x(c.data||[]),o(c.total||0)}catch(c){console.error(s("serviceAccount.loadError",{defaultValue:"Failed to load service accounts"}),c),f.error(s("serviceAccount.loadError",{defaultValue:"Failed to load service accounts"}))}finally{u(!1)}},[g,s]);d.useEffect(()=>{h()},[h]);const k=c=>{i({...g,current:B.DEFAULT_CURRENT,search:c.search})},T=()=>{_.resetFields(),i({current:B.DEFAULT_CURRENT,page_size:B.DEFAULT_PAGE_SIZE,search:void 0})},K=(c,y)=>{i(z=>({...z,current:c,page_size:y}))},M=()=>{S(null),V(!0)},L=c=>{S(c.id),V(!0)},O=()=>{V(!1),n.resetFields()},A=async c=>{try{await je(c),f.success(s("serviceAccount.deleteSuccess",{defaultValue:"Service account deleted successfully"})),h()}catch(y){console.error(s("serviceAccount.deleteError",{defaultValue:"Failed to delete service account"}),y),f.error(s("serviceAccount.deleteError",{defaultValue:"Failed to delete service account"}))}},E=async c=>{const y=c.status==="active"?"disabled":"active";try{await Ae(c.id,y),f.success(s("serviceAccount.statusUpdateSuccess",{defaultValue:"Status updated successfully"})),h()}catch(z){console.error(s("serviceAccount.statusUpdateError",{defaultValue:"Failed to update status"}),z),f.error(s("serviceAccount.statusUpdateError",{defaultValue:"Failed to update status"}))}},l=[{title:s("serviceAccount.name",{defaultValue:"Name"}),dataIndex:"name",key:"name",render:(c,y)=>e.jsx(I,{permission:"authorization:service_account:view",fallback:c,children:e.jsx(Se,{to:`/authorization/service-accounts/${y.id}`,children:c})})},{title:s("serviceAccount.description",{defaultValue:"Description"}),dataIndex:"description",key:"description",render:c=>e.jsx(N,{title:c,children:e.jsx("span",{children:(c==null?void 0:c.length)>30?`${c.substring(0,30)}...`:c})})},{title:s("serviceAccount.status",{defaultValue:"Status"}),dataIndex:"status",key:"status",render:c=>c==="active"?e.jsx(R,{status:"success",text:s("serviceAccount.statusActive",{defaultValue:"Active"})}):e.jsx(R,{status:"error",text:s("serviceAccount.statusDisabled",{defaultValue:"Disabled"})})},{title:s("serviceAccount.roles",{defaultValue:"Roles"}),key:"roles",render:(c,y)=>{var z;return e.jsxs(b,{size:[0,4],wrap:!0,children:[(z=y.roles)==null?void 0:z.map(le=>e.jsx(J,{color:"blue",children:le.name},le.id)),(!y.roles||y.roles.length===0)&&e.jsx(J,{children:s("serviceAccount.noRoles",{defaultValue:"No Roles"})})]})}},{title:s("serviceAccount.hasPolicy",{defaultValue:"Has Policy"}),key:"policy",render:(c,y)=>y.policy_document&&y.policy_document.Statement&&y.policy_document.Statement.length>0?e.jsx(J,{color:"green",icon:e.jsx(ee,{}),children:s("serviceAccount.hasPolicy",{defaultValue:"Has Policy"})}):e.jsx(J,{color:"default",icon:e.jsx(ge,{}),children:s("serviceAccount.noPolicy",{defaultValue:"No Policy"})})},{title:s("serviceAccount.createdAt",{defaultValue:"Created At"}),dataIndex:"created_at",key:"created_at",render:c=>P(c)},{title:s("serviceAccount.lastAccess",{defaultValue:"Last Access"}),dataIndex:"last_access",key:"last_access",render:c=>c?P(c):s("serviceAccount.neverAccessed",{defaultValue:"Never Accessed"})},{title:t("actions",{defaultValue:"Actions"}),key:"action",render:(c,y)=>e.jsxs(b,{size:"small",children:[e.jsx(I,{permission:"authorization:service_account:view",children:e.jsx(N,{title:s("serviceAccount.viewDetail",{defaultValue:"View Detail"}),children:e.jsx(r,{type:"text",size:"small",icon:e.jsx(be,{}),onClick:()=>j(`/authorization/service-accounts/${y.id}`)})})}),e.jsx(I,{permission:"authorization:service_account:update",children:e.jsx(N,{title:s("serviceAccount.edit",{defaultValue:"Edit"}),children:e.jsx(r,{type:"text",size:"small",icon:e.jsx(H,{}),onClick:()=>L(y)})})}),e.jsx(I,{permission:"authorization:service_account:update",children:e.jsx(N,{title:y.status==="active"?t("disable",{defaultValue:"Disable"}):t("enable",{defaultValue:"Enable"}),children:e.jsx(r,{type:"text",size:"small",icon:y.status==="active"?e.jsx(Q,{}):e.jsx(ee,{}),onClick:()=>E(y)})})}),e.jsx(I,{permission:"authorization:service_account:delete",children:e.jsx(N,{title:s("serviceAccount.delete",{defaultValue:"Delete"}),children:e.jsx(ce,{title:s("serviceAccount.deleteConfirm",{defaultValue:"Are you sure you want to delete this service account?"}),onConfirm:()=>A(y.id),okText:t("confirm",{defaultValue:"Confirm"}),cancelText:t("cancel",{defaultValue:"Cancel"}),children:e.jsx(r,{type:"text",size:"small",danger:!0,icon:e.jsx(ae,{})})})})})]})}];return e.jsxs("div",{children:[e.jsx($,{style:{marginBottom:16},children:e.jsx(v,{form:_,layout:"horizontal",onFinish:k,initialValues:{search:g.search},style:{marginBottom:0},children:e.jsxs(te,{gutter:16,children:[e.jsx(G,{xs:24,sm:12,md:8,lg:6,children:e.jsx(v.Item,{name:"search",label:t("keyword",{defaultValue:"Keyword"}),children:e.jsx(Y,{placeholder:s("serviceAccount.searchPlaceholder",{defaultValue:"Search by name or description"}),allowClear:!0,prefix:e.jsx(_e,{})})})}),e.jsx(G,{xs:24,sm:12,md:8,lg:6,style:{display:"flex",alignItems:"flex-end"},children:e.jsx(v.Item,{children:e.jsxs(b,{children:[e.jsx(r,{type:"primary",htmlType:"submit",icon:e.jsx(we,{}),children:t("filter",{defaultValue:"Filter"})}),e.jsx(r,{onClick:T,icon:e.jsx(ie,{}),children:t("reset",{defaultValue:"Reset"})})]})})})]})})}),e.jsxs($,{children:[e.jsx("div",{style:{marginBottom:16},children:e.jsxs(te,{justify:"space-between",align:"middle",children:[e.jsx(G,{children:e.jsx(r,{type:"primary",onClick:T,icon:e.jsx(ie,{}),children:t("refresh",{defaultValue:"Refresh"})})}),e.jsx(G,{children:e.jsx(I,{permission:"authorization:service_account:create",children:e.jsx(r,{type:"primary",icon:e.jsx(fe,{}),onClick:M,children:s("serviceAccount.create",{defaultValue:"Create Service Account"})})})})]})}),e.jsx(he,{rowKey:"id",dataSource:p,columns:l,loading:a,pagination:{current:g.current,pageSize:g.page_size,total:m,onChange:K,showSizeChanger:!0,showQuickJumper:!0,showTotal:c=>t("totalItems",{defaultValue:`Total ${c} items`,total:c})}})]}),e.jsx(Ve,{serviceAccountID:w,onClose:O,open:C,onSuccess:()=>{h()}})]})},rt=Object.freeze(Object.defineProperty({__proto__:null,default:Qe},Symbol.toStringTag,{value:"Module"})),{Text:q,Paragraph:ne}=ye,{TextArea:Xe}=Y,Ye=({serviceAccountID:s})=>{const{t}=F("authorization"),{t:j}=F("common"),[_,n]=d.useState([]),[a,u]=d.useState(!1),[p,x]=d.useState(!1),[m]=v.useForm(),[o,C]=d.useState(null),[V,w]=d.useState(null),[S,g]=d.useState(!1),i=async()=>{if(s){u(!0);try{const l=await Be(s);n(l)}catch(l){console.error("Failed to load access keys:",l),f.error(t("serviceAccount.loadKeysError",{defaultValue:"Failed to load access keys."}))}finally{u(!1)}}};d.useEffect(()=>{i()},[s]);const h=l=>{navigator.clipboard.writeText(l).then(()=>{f.success(t("serviceAccount.copyKeySuccess",{defaultValue:"Copied to clipboard!"}))},c=>{console.error("Could not copy text: ",c)})},k=()=>{C(null),m.resetFields(),x(!0)},T=l=>{C(l),m.setFieldsValue({name:l.name,description:l.description,status:l.status==="active",expires_at:l.expires_at?Re(l.expires_at):void 0}),x(!0)},K=()=>{x(!1),m.resetFields()},{run:M,loading:L}=U(async()=>{const l=await m.validateFields();if(o){const c=await Le(s,o.id,{name:l.name,description:l.description,status:l.status?"active":"disabled",expires_at:l.expires_at?l.expires_at.toISOString():void 0});return x(!1),c}else{const c=await Oe(s,{name:l.name,description:l.description,expires_at:l.expires_at?l.expires_at.toISOString():void 0});w(c),x(!1),g(!0)}},{manual:!0,onSuccess:()=>{f.success(t("serviceAccount.updateKeySuccess",{defaultValue:"Access key updated successfully."})),i()},onError:()=>{f.error(t("serviceAccount.updateKeyError",{defaultValue:"Failed to update access key."}))}}),O=async l=>{try{await qe(s,l),f.success(t("serviceAccount.deleteKeySuccess",{defaultValue:"Access key deleted successfully."})),i()}catch(c){console.error("Failed to delete key:",c),f.error(t("serviceAccount.deleteKeyError",{defaultValue:"Failed to delete access key."}))}},A=()=>{g(!1),w(null)},E=[{title:t("serviceAccount.keyName",{defaultValue:"Name"}),dataIndex:"name",key:"name"},{title:t("serviceAccount.accessKey",{defaultValue:"Access Key ID"}),dataIndex:"access_key_id",key:"access_key_id",render:l=>e.jsxs(b,{children:[e.jsx(se,{}),e.jsx(q,{copyable:!0,children:l})]})},{title:t("serviceAccount.keyDescription",{defaultValue:"Description"}),dataIndex:"description",key:"description"},{title:t("serviceAccount.keyStatus",{defaultValue:"Status"}),dataIndex:"status",key:"status",render:l=>l==="active"?e.jsx(R,{status:"success",text:t("serviceAccount.keyActive",{defaultValue:"Active"})}):e.jsx(R,{status:"error",text:t("serviceAccount.keyDisabled",{defaultValue:"Disabled"})})},{title:t("serviceAccount.keyExpires",{defaultValue:"Expires At"}),dataIndex:"expires_at",key:"expires_at",render:l=>l?P(l):e.jsx(q,{type:"secondary",children:t("serviceAccount.neverExpires",{defaultValue:"Never"})})},{title:t("serviceAccount.keyLastUsed",{defaultValue:"Last Used"}),dataIndex:"last_used",key:"last_used",render:l=>l?P(l):e.jsx(q,{type:"secondary",children:t("serviceAccount.keyNeverUsed",{defaultValue:"Never"})})},{title:j("actions",{defaultValue:"Actions"}),key:"action",render:(l,c)=>e.jsxs(b,{size:"small",children:[e.jsx(N,{title:t("serviceAccount.updateKey",{defaultValue:"Update Key"}),children:e.jsx(r,{type:"text",icon:e.jsx(H,{}),onClick:()=>T(c)})}),e.jsx(ce,{title:t("serviceAccount.deleteKeyConfirm",{defaultValue:"Are you sure you want to delete this access key?"}),onConfirm:()=>O(c.id),okText:j("confirm",{defaultValue:"Confirm"}),cancelText:j("cancel",{defaultValue:"Cancel"}),children:e.jsx(r,{type:"text",danger:!0,icon:e.jsx(ae,{})})})]})}];return e.jsxs(e.Fragment,{children:[e.jsx($,{title:e.jsxs(b,{children:[e.jsx(se,{}),t("serviceAccount.accessKeys",{defaultValue:"Access Keys"})]}),extra:e.jsxs(b,{children:[e.jsx(r,{icon:e.jsx(pe,{}),onClick:i,loading:a,children:j("refresh",{defaultValue:"Refresh"})}),e.jsx(r,{type:"primary",icon:e.jsx(fe,{}),onClick:k,children:t("serviceAccount.createAccessKey",{defaultValue:"Create Access Key"})})]}),children:e.jsx(he,{columns:E,dataSource:_,rowKey:"id",loading:a,pagination:!1})}),e.jsx(Z,{title:o?t("serviceAccount.updateKey",{defaultValue:"Update Access Key"}):t("serviceAccount.createAccessKey",{defaultValue:"Create Access Key"}),open:p,onOk:M,confirmLoading:L,onCancel:K,children:e.jsxs(v,{form:m,layout:"vertical",children:[e.jsx(v.Item,{name:"name",label:t("serviceAccount.keyName",{defaultValue:"Key Name"}),rules:[{required:!0,message:t("serviceAccount.keyNameRequired",{defaultValue:"Please enter a name for the access key."})}],children:e.jsx(Y,{placeholder:t("serviceAccount.keyNamePlaceholder",{defaultValue:"Enter key name"})})}),e.jsx(v.Item,{name:"description",label:t("serviceAccount.keyDescription",{defaultValue:"Description"}),children:e.jsx(Xe,{rows:3,placeholder:t("serviceAccount.keyDescriptionPlaceholder",{defaultValue:"Enter key description (optional)"})})}),o&&e.jsx(v.Item,{name:"status",label:t("serviceAccount.keyStatus",{defaultValue:"Status"}),valuePropName:"checked",children:e.jsx(ke,{checkedChildren:t("serviceAccount.keyActive",{defaultValue:"Active"}),unCheckedChildren:t("serviceAccount.keyDisabled",{defaultValue:"Disabled"})})}),e.jsx(v.Item,{name:"expires_at",label:t("serviceAccount.keyExpires",{defaultValue:"Expires At"}),children:e.jsx(Ee,{showTime:!0,placeholder:t("serviceAccount.selectExpireDate",{defaultValue:"Select expiry date (optional)"}),style:{width:"100%"}})})]})}),e.jsxs(Z,{title:e.jsxs(b,{children:[e.jsx(Fe,{style:{color:"#faad14"}}),t("serviceAccount.secretNoticeTitle",{defaultValue:"Access Key Created - Important!"})]}),open:S,footer:[e.jsx(r,{onClick:A,children:j("confirm",{defaultValue:"I have copied the secret key. Close"})},"close")],closable:!1,children:[e.jsx(Ce,{message:t("serviceAccount.secretNoticeMessage",{defaultValue:"Your new Secret Access Key is displayed below. This is the only time you will be able to see this secret. Please copy it and store it securely."}),type:"warning",showIcon:!0,style:{marginBottom:16}}),V&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs(q,{strong:!0,children:[t("serviceAccount.accessKey",{defaultValue:"Access Key ID"}),":"]}),e.jsx(ne,{copyable:{text:V.access_key_id},children:V.access_key_id})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsxs(q,{strong:!0,children:[t("serviceAccount.secretKey",{defaultValue:"Secret Access Key"}),":"]}),e.jsx(ne,{copyable:{text:V.secret_access_key||""},children:V.secret_access_key})]}),e.jsx(r,{type:"primary",icon:e.jsx(Ie,{}),onClick:()=>{const l=`Access Key: ${V.access_key_id}
Secret Key: ${V.secret_access_key}`;h(l)},block:!0,children:t("serviceAccount.copyToClipboard",{defaultValue:"Copy Keys to Clipboard"})})]})]})]})},{Text:re}=ye,et=({serviceAccount:s,onRefresh:t,loading:j})=>{const{id:_}=s||{},{t:n}=F("authorization"),{t:a}=F("common"),[u,p]=d.useState([]),[x,m]=d.useState([]);d.useEffect(()=>{m((s==null?void 0:s.roles)||[])},[s]);const[o,C]=d.useState(void 0),{loading:V}=U(async()=>Je(1,20,o),{onSuccess:i=>{const h=i.data;x.forEach(k=>{h.find(K=>K.id===k.id)||h.push(k)}),p(h)},onError:i=>{console.error("Failed to load roles:",i),f.error(n("serviceAccount.loadRolesError",{defaultValue:"Failed to load roles."}))},debounceWait:300,refreshDeps:[o]}),{run:w,loading:S}=U(async()=>{if(_)return Ge(_,{role_ids:x.map(i=>i.id)})},{onSuccess:()=>{f.success(n("serviceAccount.assignRolesSuccess",{defaultValue:"Roles assigned successfully."})),t()},onError:i=>{console.error("Failed to assign roles:",i),f.error(n("serviceAccount.assignRolesError",{defaultValue:"Failed to assign roles."}))},manual:!0}),g=i=>{m(i.map(h=>u.find(k=>k.id===h)||{id:h,name:h,description:h}))};return e.jsx($,{title:e.jsxs(b,{children:[e.jsx(Q,{}),n("serviceAccount.authorization",{defaultValue:"Authorization"})]}),extra:e.jsx(r,{icon:e.jsx(pe,{}),onClick:()=>{t()},disabled:j||S,loading:S,children:a("refresh",{defaultValue:"Refresh"})}),children:S?e.jsx(Te,{active:!0,paragraph:{rows:4}}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(re,{children:n("serviceAccount.roles",{defaultValue:"Roles"})}),e.jsx("div",{style:{marginTop:8},children:x.length>0?u.filter(i=>x.some(h=>h.id===i.id)).map(i=>e.jsx(J,{color:"blue",children:i.name},i.id)):e.jsx(X,{image:X.PRESENTED_IMAGE_SIMPLE,description:n("serviceAccount.noRoles",{defaultValue:"No roles assigned."}),style:{margin:"10px 0"}})})]}),e.jsxs("div",{style:{marginBottom:16},children:[e.jsx(re,{children:n("serviceAccount.assignRoles",{defaultValue:"Assign Roles"})}),e.jsx(xe,{mode:"multiple",style:{width:"100%",marginTop:8},placeholder:n("serviceAccount.selectRoles",{defaultValue:"Select roles to assign"}),value:x.map(i=>i.id),onSearch:i=>{C(i)},onDropdownVisibleChange:i=>{i&&C(void 0)},onChange:g,loading:j||V,optionFilterProp:"label",options:u.map(i=>({label:i.name,value:i.id,title:i.description}))})]}),e.jsx("div",{style:{marginTop:16},children:e.jsx(r,{type:"primary",onClick:w,loading:S,disabled:j,children:n("serviceAccount.assignRoles",{defaultValue:"Assign Roles"})})})]})})},{TabPane:W}=me,tt={allow_all:{Statement:[{Effect:"Allow",Action:["*"]}]},deny_all:{Statement:[{Effect:"Deny",Action:["*"]}]},allow_with_action:{Statement:[{Effect:"Allow",Action:["authorization:user:view"]}]},allow_with_condition:{Statement:[{Effect:"Allow",Action:["authorization:user:update"],Condition:{StringEquals:{"id:":"abcdef"}}},{Effect:"Deny",Action:["*"]}]},allow_with_uri:{Statement:[{Effect:"Allow",Action:["authorization:user:view"],Condition:{StringEquals:{"http.uri":"/api/users/abcdef","http.method":"GET"}}},{Effect:"Deny",Action:["*"]}]}},st=Ke(({css:s})=>({rolePolicy:s`
       .ant-collapse-content>.ant-collapse-content-box{
        padding: 2px;
      }
      .ant-form-item-additional>#policy_document_extra{
        min-height: 0;
      }
    `,rolePermissionExtra:s`
      float: right;
      z-index: 1001;
      position: sticky;
    `,rolePolicyExtra:s`
      position: absolute;
      right: 20px;
      top: 5px;
    `})),ct=()=>{const{styles:s}=st(),n=De().hash.replace("#","")||"basic",{t:a}=F("authorization"),{t:u}=F("common"),{id:p}=Pe(),x=de(),{hasPermission:m}=He(),[o,C]=d.useState(null),[V,w]=d.useState(!1),[S]=v.useForm(),[g,i]=d.useState(!1);if(!p)return e.jsx(Ze,{});const{run:h,loading:k}=U(async()=>{if(p)return ve(p)},{onSuccess:A=>{C(A||null)}});d.useEffect(()=>{h()},[p]);const T=A=>{x(`#${A}`)},K=async()=>{if(p)try{await je(p),f.success(a("serviceAccount.deleteSuccess",{defaultValue:"Service account deleted successfully."})),x("/authorization/service-accounts")}catch(A){console.error(a("serviceAccount.deleteError",{defaultValue:"Failed to delete service account."}),A),f.error(a("serviceAccount.deleteError",{defaultValue:"Failed to delete service account."}))}},{run:M,loading:L}=U(async()=>{if(o)return Ae(p,o.status==="active"?"disabled":"active")},{onSuccess:A=>{C(A||null),f.success(a("serviceAccount.statusUpdateSuccess",{defaultValue:"Service account status updated successfully."}))},onError:A=>{console.error(a("serviceAccount.statusUpdateError",{defaultValue:"Failed to update service account status."}),A),f.error(a("serviceAccount.statusUpdateError",{defaultValue:"Failed to update service account status."}))},manual:!0}),O=async A=>{if(p)try{let E;try{E=JSON.parse(A.policy_document)}catch{f.error(a("serviceAccount.policyInvalidJson",{defaultValue:"Invalid JSON format for policy document."}));return}await We(p,{policy_document:E}),f.success(a("serviceAccount.policyUpdateSuccess",{defaultValue:"Policy document updated successfully."})),w(!1),h()}catch(E){console.error(a("serviceAccount.policyUpdateError",{defaultValue:"Failed to update policy document."}),E),f.error(a("serviceAccount.policyUpdateError",{defaultValue:"Failed to update policy document."}))}};return k?e.jsx(oe,{size:"large",style:{display:"flex",justifyContent:"center",padding:"50px"}}):o?e.jsxs($,{title:e.jsxs(b,{children:[e.jsx(Ne,{}),o.name,o.status==="active"?e.jsx(R,{status:"success",text:a("serviceAccount.status.active",{defaultValue:"Active"})}):e.jsx(R,{status:"error",text:a("serviceAccount.status.disabled",{defaultValue:"Disabled"})})]}),extra:e.jsxs(b,{children:[e.jsx(I,{permission:"authorization:service_account:update",children:e.jsx(r,{type:"primary",icon:e.jsx(H,{}),onClick:()=>i(!0),disabled:g,children:u("edit",{defaultValue:"Edit"})})}),e.jsx(I,{permission:"authorization:service_account:update",children:e.jsx(r,{icon:o.status==="active"?e.jsx(Q,{}):e.jsx(ee,{}),onClick:M,loading:L,children:o.status==="active"?u("disable",{defaultValue:"Disable"}):u("enable",{defaultValue:"Enable"})})}),e.jsx(I,{permission:"authorization:service_account:delete",children:e.jsx(ce,{title:a("serviceAccount.deleteConfirm",{defaultValue:"Are you sure you want to delete this service account?"}),onConfirm:K,okText:u("confirm",{defaultValue:"Confirm"}),cancelText:u("cancel",{defaultValue:"Cancel"}),children:e.jsx(r,{danger:!0,icon:e.jsx(ae,{}),children:u("delete",{defaultValue:"Delete"})})})}),e.jsx(r,{icon:e.jsx(ze,{}),onClick:()=>x("/authorization/service-accounts"),children:u("back",{defaultValue:"Back"})})]}),children:[e.jsxs(me,{defaultActiveKey:n,onChange:T,children:[e.jsx(W,{tab:a("serviceAccount.tabs.basic",{defaultValue:"Basic Information"}),children:e.jsxs(D,{bordered:!0,column:2,children:[e.jsx(D.Item,{label:a("serviceAccount.name",{defaultValue:"Name"}),span:2,children:o.name}),e.jsx(D.Item,{label:a("serviceAccount.description",{defaultValue:"Description"}),span:2,children:o.description||a("serviceAccount.noDescription",{defaultValue:"N/A"})}),e.jsx(D.Item,{label:a("serviceAccount.status",{defaultValue:"Status"}),children:o.status==="active"?e.jsx(R,{status:"success",text:a("serviceAccount.statusActive",{defaultValue:"Active"})}):e.jsx(R,{status:"error",text:a("serviceAccount.statusDisabled",{defaultValue:"Disabled"})})}),e.jsx(D.Item,{label:a("serviceAccount.lastAccess",{defaultValue:"Last Access"}),children:o.last_access?P(o.last_access):a("serviceAccount.neverAccessed",{defaultValue:"Never"})}),e.jsx(D.Item,{label:a("serviceAccount.createdAt",{defaultValue:"Created At"}),children:P(o.created_at)}),e.jsx(D.Item,{label:a("serviceAccount.updatedAt",{defaultValue:"Updated At"}),children:P(o.updated_at)})]})},"basic"),e.jsx(W,{tab:e.jsxs("span",{children:[e.jsx(se,{}),a("serviceAccount.accessKeys",{defaultValue:"Access Keys"})]}),disabled:!m("authorization:service_account:access_key:list"),children:e.jsx(Ye,{serviceAccountID:p})},"access-keys"),e.jsx(W,{tab:e.jsxs("span",{children:[e.jsx(Q,{}),a("serviceAccount.authorization",{defaultValue:"Authorization"})]}),disabled:!m("authorization:service_account:role:list"),children:e.jsx(et,{serviceAccount:o,onRefresh:h})},"authorization"),e.jsxs(W,{tab:a("serviceAccount.tabs.policy",{defaultValue:"Policy Document"}),children:[e.jsx("div",{style:{marginBottom:16},children:e.jsx(te,{justify:"end",children:e.jsx(G,{children:e.jsx(I,{permission:"authorization:service_account:update",children:e.jsx(r,{type:"primary",icon:e.jsx(H,{}),onClick:()=>{w(!0),S.setFieldsValue({policy_document:JSON.stringify(o.policy_document,null,2)})},children:a("serviceAccount.editPolicy",{defaultValue:"Edit Policy"})})})})})}),e.jsx(oe,{spinning:k,children:o.policy_document&&o.policy_document.Statement&&o.policy_document.Statement.length>0?e.jsx($,{children:e.jsx("pre",{style:{whiteSpace:"pre-wrap",overflowX:"auto"},children:JSON.stringify(o.policy_document,null,2)})}):e.jsx(X,{description:a("serviceAccount.noPolicy",{defaultValue:"No policy document defined for this service account."})})})]},"policy")]}),e.jsx(Z,{title:a("serviceAccount.editPolicy",{defaultValue:"Edit Policy"}),open:V,onCancel:()=>{w(!1),S.resetFields()},footer:null,width:700,children:e.jsxs(v,{form:S,layout:"vertical",onFinish:O,children:[e.jsx(v.Item,{name:"policy_document",extra:e.jsx("span",{className:s.rolePolicyExtra,children:e.jsx(xe,{style:{width:120},placeholder:a("serviceAccount.insertTemplate",{defaultValue:"Insert Template"}),value:a("serviceAccount.insertTemplate",{defaultValue:"Insert Template"}),options:[{label:a("serviceAccount.allowAll",{defaultValue:"Allow All"}),value:"allow_all"},{label:a("serviceAccount.denyAll",{defaultValue:"Deny All"}),value:"deny_all"},{label:a("serviceAccount.allowWithAction",{defaultValue:"Allow with Action"}),value:"allow_with_action"},{label:a("serviceAccount.denyWithCondition",{defaultValue:"Allow with Condition"}),value:"allow_with_condition"},{label:a("serviceAccount.allowWithUri",{defaultValue:"Allow with URI"}),value:"allow_with_uri"}],onChange:A=>{const E=tt[A];E&&S.setFieldValue("policy_document",JSON.stringify(E,null,2))}})}),children:e.jsx(ue,{rows:15,style:{fontFamily:"monospace"},placeholder:`{
    "Statement": [
        {
            "Effect": "Allow",
            "Action": [
                "account:EnableRegion",
                "account:DisableRegion"
            ],
            "Condition": {
                "StringEquals": {"id:": "abcdef"}
            }
        },
        {
            "Effect": "Allow",
            "Action": [
                "*"
            ]
        }
    ]
}`})}),e.jsx(v.Item,{children:e.jsxs(b,{children:[e.jsx(r,{type:"primary",htmlType:"submit",children:u("save",{defaultValue:"Save"})}),e.jsx(r,{onClick:()=>w(!1),children:u("cancel",{defaultValue:"Cancel"})})]})})]})}),e.jsx(Ve,{serviceAccountID:p,onClose:()=>i(!1),open:g})]}):e.jsx("div",{style:{textAlign:"center",padding:"50px 0"},children:e.jsx(X,{description:a("serviceAccount.notFound",{defaultValue:"Service account not found."})})})},ut=Object.freeze(Object.defineProperty({__proto__:null,default:ct},Symbol.toStringTag,{value:"Module"}));export{rt as S,ut as a};
