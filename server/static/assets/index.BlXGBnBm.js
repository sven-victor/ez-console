const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dashboard.CkhuFTIr.js","assets/vendor.2aaXemON.js","assets/vite.BF1G3H_w.js","assets/vendor.D-Ncpkvi.css","assets/contexts.DYawpXr1.js","assets/client.Bmt2FeTo.js","assets/base.zBL7EeCi.js","assets/components.BmqVvmt5.js","assets/ai.BGenRt8i.js","assets/authorization.BarOdU4N.js","assets/system.BjCXfIZ_.js","assets/oauth.Dwz11D9p.js","assets/toolsets.VecF_3YQ.js","assets/login.DTyTUs6G.js","assets/profile.Dr5oIJuv.js","assets/not_found.Cv6PIsEL.js","assets/forbidden.yR_45MJk.js","assets/users.st8UVDfT.js","assets/roles.DBTOxisv.js","assets/system-settings.B3ZpYhrT.js","assets/audit.vSmpcrPK.js","assets/service-accounts.Dqjm3UYs.js"])))=>i.map(i=>d[i]);
import{_ as u}from"./vite.BF1G3H_w.js";import{r as n,j as e,ar as te,as as ae,at as $,au as ne,av as ie,aw as se,ax as T,ay as D,u as k,az as oe,aq as re,aA as P,aB as le,aC as ce,aD as ue,aE as de,S as he,p as me,aF as pe,aG as fe,aH as _e,aI as xe,aJ as ge,aK as ve,aL as ye,aM as je,aN as ze,aO as N,aP as Ee,aQ as Re,aR as Le,aS as Ae,aT as Ie,aU as F,aV as we}from"./vendor.2aaXemON.js";import{L as be,H as M,A as U,a as Se,b as Pe,P as $e}from"./components.BmqVvmt5.js";import{a as De,u as Oe,A as Ve}from"./contexts.DYawpXr1.js";import{a as Te}from"./ai.BGenRt8i.js";import{a as ke}from"./authorization.BarOdU4N.js";import{b as Ne,g as Q}from"./base.zBL7EeCi.js";import{s as Be}from"./system.BjCXfIZ_.js";import{o as Ce}from"./oauth.Dwz11D9p.js";import{t as Fe}from"./toolsets.VecF_3YQ.js";import"./index.BlXGBnBm.js";import"./client.Bmt2FeTo.js";const Me=n.lazy(()=>u(()=>import("./dashboard.CkhuFTIr.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12]))),Ue=n.lazy(()=>u(()=>import("./login.DTyTUs6G.js"),__vite__mapDeps([13,1,2,3,4,5,6,7,8,9,10,11,12]))),He=n.lazy(()=>u(()=>import("./profile.Dr5oIJuv.js"),__vite__mapDeps([14,1,2,3,7,4,5,6,8,9,10,11,12]))),H=n.lazy(()=>u(()=>import("./not_found.Cv6PIsEL.js"),__vite__mapDeps([15,1,2,3]))),Ke=n.lazy(()=>u(()=>import("./forbidden.yR_45MJk.js"),__vite__mapDeps([16,1,2,3]))),qe=n.lazy(()=>u(()=>import("./users.st8UVDfT.js").then(o=>o.U),__vite__mapDeps([17,1,2,3,7,4,5,6]))),Qe=n.lazy(()=>u(()=>import("./users.st8UVDfT.js").then(o=>o.a),__vite__mapDeps([17,1,2,3,7,4,5,6]))),K=n.lazy(()=>u(()=>import("./users.st8UVDfT.js").then(o=>o.b),__vite__mapDeps([17,1,2,3,7,4,5,6]))),Ge=n.lazy(()=>u(()=>import("./roles.DBTOxisv.js"),__vite__mapDeps([18,1,2,3,7,4,5,6,8,9,10,11,12]))),Je=n.lazy(()=>u(()=>import("./system-settings.B3ZpYhrT.js").then(o=>o.i),__vite__mapDeps([19,1,2,3,6,5,7,4]))),We=n.lazy(()=>u(()=>import("./system-settings.B3ZpYhrT.js").then(o=>o.O),__vite__mapDeps([19,1,2,3,6,5,7,4]))),Ye=n.lazy(()=>u(()=>import("./audit.vSmpcrPK.js"),__vite__mapDeps([20,1,2,3,7,4,5,6,8,9,10,11,12]))),Xe=n.lazy(()=>u(()=>import("./service-accounts.Dqjm3UYs.js").then(o=>o.S),__vite__mapDeps([21,1,2,3,7,4,5,6,15]))),Ze=n.lazy(()=>u(()=>import("./service-accounts.Dqjm3UYs.js").then(o=>o.a),__vite__mapDeps([21,1,2,3,7,4,5,6,15])));function l(o,h){return e.jsx(n.Suspense,{fallback:e.jsx(be,{}),children:e.jsx(o,{...h})})}const et=({transformSettingTabs:o,transformLangConfig:h,extraPrivateRoutes:g=[],extraPublicRoutes:v=[]})=>{const y=[{path:"/login",element:l(Ue,{transformLangConfig:h}),index:!0},{path:"/404",element:l(H),index:!0},{path:"/403",element:l(Ke),index:!0},{path:"/system/settings/oauth/test-callback",element:l(We),index:!0},...v],j=[{path:"/",is_private:!0,children:[{path:"/",element:l(Me),name:"dashboard",icon:e.jsx(te,{}),index:!0},{path:"/profile",element:l(He),name:void 0,index:!0},{name:"authorization",icon:e.jsx($,{}),permissions:["authorization:user:view","authorization:user:create","authorization:user:update","authorization:user:delete","authorization:service_account:view","authorization:service_account:create","authorization:service_account:update","authorization:service_account:delete"],children:[{path:"/authorization/roles",name:"roles",icon:e.jsx(ae,{}),permissions:["authorization:role:view","authorization:role:create","authorization:role:update","authorization:role:delete"],children:[{element:l(Ge),permissions:["authorization:role:view"],index:!0}]},{path:"/authorization/users",name:"users",icon:e.jsx($,{}),permissions:["authorization:user:view","authorization:user:list","authorization:user:create","authorization:user:update","authorization:user:delete"],children:[{element:l(qe),permissions:["authorization:user:list"],index:!0},{path:"/authorization/users/create",element:l(K),permissions:["authorization:user:create"],index:!0},{path:"/authorization/users/:id",element:l(Qe),permissions:["authorization:user:view"],index:!0},{path:"/authorization/users/:id/edit",element:l(K),permissions:["authorization:user:update"],index:!0}]},{path:"/authorization/service-accounts",name:"serviceAccounts",icon:e.jsx($,{}),permissions:["authorization:service_account:view"],children:[{element:l(Xe),permissions:["authorization:service_account:view"],index:!0},{path:"/authorization/service-accounts/:id",element:l(Ze),permissions:["authorization:service_account:view"],index:!0}]}]},...g,{name:"system",icon:e.jsx(se,{}),permissions:["system:settings:view","system:settings:update","system:audit:view"],children:[{path:"/system/settings",icon:e.jsx(ne,{}),index:!0,name:"settings",permissions:["system:settings:view","system:settings:update"],element:l(Je,{transformItems:o})},{path:"/system/audit",icon:e.jsx(ie,{}),name:"audit",permissions:["system:audit:view"],index:!0,element:l(Ye)}]},{path:"*",element:l(H),index:!0}]}];return[...y,...j]},tt={ai:Te,authorization:ke,base:Ne,system:Be,oauth:Ce,toolsets:Fe},{Header:at,Content:nt,Footer:it,Sider:st}=T,{SubMenu:ot}=D,rt=({element:o,routes:h,transformLangConfig:g,menuStyle:v="dark",transformHeaderItems:y=m=>m,renderLayout:j})=>{const{t:m,i18n:z}=k(),{t:c}=k("common"),[E,I]=n.useState(!1),_=oe(),{hasPermission:w}=De(),R=re(),{logout:L,user:i}=Oe(),[s,A]=n.useState([]),[b,S]=n.useState(null),[O,G]=n.useState("Loading..."),[x,J]=n.useState(null);_.pathname!=="/profile"&&(i&&i.mfa_enforced&&!i.mfa_enabled?R("/profile#mfa"):i&&i.status==="password_expired"&&R("/profile#password"));const W=()=>{L(),window.location.href=Q("/login?redirect="+encodeURIComponent(window.location.href))},Y=[{key:"profile",label:e.jsx(P,{to:"/profile",children:c("profile")})},{key:"logout",label:c("logout"),onClick:W}];n.useEffect(()=>{tt.system.getSiteConfig().then(a=>{var t;const r=a.navigation.filter(d=>d.path!==a.home_page),f=[...a.home_page?[{name:"home",path:a.home_page}]:[],...r];f.length>1?A(f):A([]),S(a.logo),J(a),(t=document.getElementById("site-icon"))==null||t.setAttribute("href",a.logo)})},[]),n.useEffect(()=>{z.language&&G((x==null?void 0:x.name_i18n[z.language])||(x==null?void 0:x.name)||"")},[x,z.language]);const V=()=>{const a=de(h,_.pathname),r=[];if(a){for(const[f,t]of a.entries())if(t.route.path==="/"&&!t.route.name)r.push({href:t.route.path,title:c("home"),key:"home"});else if(t.route.name){const d=a.slice(0,f+1).map(p=>p.route.name).filter(Boolean).join(".");r.push({path:t.route.path,title:t.route.name?m(`breadcrumbs.${d}`):void 0,key:t.route.path})}}return r},X=a=>a.some(r=>w(r)),Z=le.flatMapDeep(h,a=>a.children).map(a=>a==null?void 0:a.name).filter(a=>a!==void 0),B=(a,r=[])=>{const f=t=>t&&t.replace(/_/g," ").split(" ").map(d=>d.charAt(0).toUpperCase()+d.slice(1)).join(" ");return a.flatMap(t=>"children"in t&&t.children&&!t.name?t.children:[t]).map(t=>{if(t.permissions&&!X(t.permissions))return null;const d=f(t.name);if(!t.name)return null;if("children"in t&&t.children){const p=B(t.children,[...r,t.name]);return p.length==0&&t.path?e.jsx(D.Item,{icon:t.icon,children:e.jsx(P,{to:t.path,children:m(`menu.${[...r,t.name].join(".")}`,{defaultValue:d})})},t.path):e.jsx(ot,{icon:t.icon,title:m(`menu.${[...r,t.name,t.name].join(".")}`,{defaultValue:d}),children:p},t.path??t.name)}return t.name&&t.path?e.jsx(D.Item,{icon:t.icon,children:e.jsx(P,{to:t.path,children:m(`menu.${[...r,t.name].join(".")}`,{defaultValue:d})})},t.path):null}).filter(Boolean)};n.useEffect(()=>{const a=V().filter(r=>r.path!=="/").map(r=>r.title).join(" - ");a?document.title=`${O} | ${a}`:document.title=O},[V,_.pathname]);const ee=[e.jsx(M,{hidden:s.length<=1,menu:{items:s.map(a=>({key:a.path,style:{paddingRight:"20px"},label:e.jsx("a",{href:a.path,children:m(`menu.${a.name}`,{defaultValue:a.name})})}))},children:e.jsx(ce,{})}),e.jsxs(M,{menu:{items:Y},children:[i!=null&&i.avatar?e.jsx(U,{src:i.avatar}):e.jsx(U,{icon:e.jsx($,{})}),e.jsx("span",{style:{height:"1em",lineHeight:"1em",marginLeft:"5px"},children:(i==null?void 0:i.full_name)||(i==null?void 0:i.username)})]}),e.jsx(Se,{transformLangConfig:g})];return(j??((a,r,f,t,d)=>e.jsxs(T,{style:{minHeight:"100vh"},children:[e.jsxs(st,{collapsible:!0,collapsed:E,onCollapse:I,theme:v,children:[e.jsx("div",{className:"logo",style:{margin:"8px",display:"flex"},children:e.jsx("div",{style:{width:"100%",height:"100%",textAlign:"center"},children:a?e.jsx("img",{src:a,alt:"logo",style:{height:"32px",width:"32px"}}):e.jsx(he,{size:"large",tip:"Loading..."})})}),e.jsx(D,{theme:v,defaultOpenKeys:Z,defaultSelectedKeys:["1"],mode:"inline",selectedKeys:[_.pathname],children:r})]}),e.jsxs(T,{className:"site-layout",children:[e.jsxs(at,{className:"site-layout-background",style:{padding:0,display:"flex",justifyContent:"space-between"},children:[e.jsx(me,{type:"text",icon:E?e.jsx(pe,{}):e.jsx(fe,{}),onClick:()=>I(!E),style:{fontSize:"16px",width:64,height:64}}),e.jsx("div",{style:{marginRight:"20px"},children:f})]}),e.jsxs(nt,{style:{margin:"0 16px"},children:[e.jsx(_e,{style:{margin:"16px 0"},itemRender:p=>{const C=p.href||p.path;return C?e.jsx(P,{to:C,children:p.title}):e.jsx("span",{children:p.title})},items:t}),e.jsx("div",{className:"site-layout-background",style:{padding:24,minHeight:360},children:d}),e.jsx(Pe,{})]}),e.jsxs(it,{style:{textAlign:"center"},children:[" Â©",new Date().getFullYear()," ",O]})]})]})))(b,B(h),y(ee),V(),o??e.jsx(ue,{}))},lt=new xe({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1}}}),q={"zh-CN":Ee,"en-US":N,"de-DE":ze,"es-ES":je,"fr-FR":ye,"ar-AE":ve,"sv-SE":ge};function ct({transformRouter:o=c=>c,transformSettingTabs:h=c=>c,transformLangConfig:g=c=>c,extraPrivateRoutes:v=[],extraPublicRoutes:y=[],menuStyle:j="dark",transformHeaderItems:m=c=>c,renderLayout:z}){const{i18n:c}=k(),[E,I]=n.useState(q[c.language]||N);n.useEffect(()=>{I(q[c.language]||N)},[c.language]);const _=L=>L.map(i=>i.children===void 0?i:{...i,children:_(i.children)}),w=o(_(et({transformSettingTabs:h,transformLangConfig:g,extraPrivateRoutes:v,extraPublicRoutes:y}))),R=(L,i)=>L.flatMap(s=>s.is_private?[s]:"children"in s&&s.children?s.children:[s]).map((s,A)=>{const b=s.is_private?e.jsx($e,{element:e.jsx(rt,{routes:w,element:s.element,transformLangConfig:g,menuStyle:j,transformHeaderItems:m,renderLayout:z})}):s.element;if("children"in s&&s.children&&s.children.length>0)return e.jsx(F,{path:s.path,element:b,children:R(s.children,s)},s.path??s.name??A);const{path:S}=s;return e.jsx(F,{path:S,index:s.index,element:b},S??s.name??`${(i==null?void 0:i.path)??""}.${A}`)}).filter(Boolean);return e.jsx(Re,{client:lt,children:e.jsx(Le,{locale:E,children:e.jsx(Ve,{children:e.jsx(Ae,{basename:Q(),children:e.jsx(Ie,{children:R(w)})})})})})}we.createRoot(document.getElementById("root")).render(e.jsx(ct,{}));export{tt as a,l as w};
