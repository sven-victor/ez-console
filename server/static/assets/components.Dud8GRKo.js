import{j as e,S as Y,N as H,c as N,D as O,d as ee,u as b,A as te,r as d,I as se,U as ae,M as U,l as ne,e as z,P as re,R as ie,f as oe,L as le,g as G,h as ce,k as de,F as x,m as A,n as S,s as j,o as ue,C as _,p as K,q as me,t as he,v as pe,w as fe,x as W,Q as xe,y as J,z as ge,E as L,G as je,T as ye,H as Se,J as ve,K as we,O as D,V,W as Ie,X as q,Y as Q,Z as T,_ as B,$ as be,a0 as Fe,a1 as ke,a2 as Ae}from"./vendor.BL40-5vE.js";import{u as Le,a as X}from"./contexts.Dt3wwJ0J.js";import{g as Ce,f as Te}from"./base.D4vFg2QQ.js";import{a as v}from"./index.CFGX7lSC.js";import{b as E,A as ze}from"./client.DDakgimh.js";const Pe=()=>e.jsx("div",{style:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh",width:"100%"},children:e.jsx(Y,{size:"large"})}),et=({element:t,requiredPermission:n,requiredPermissions:s})=>{const{user:a,loading:i}=Le(),{hasPermission:r,hasAllPermissions:u}=X();return i?e.jsx(Pe,{}):a?n&&!r(n)?e.jsx(H,{to:"/forbidden",replace:!0}):s&&!u(s)?e.jsx(H,{to:"/forbidden",replace:!0}):t:(window.location.href=Ce("/login?redirect="+encodeURIComponent(window.location.href)),null)},Re=N(({token:t,css:n})=>({container:n`
      ${n`
        @media screen and (max-width: ${t.screenXS}px) {
          width: 100% !important;
          > * {
            border-radius: 0 !important;
          }
        }
      `}
    > *{
      background-color: ${t.colorBgElevated};
      border-radius: 4px;
      box-shadow: ${t.boxShadowTertiary};
    }
    `,iconStyle:{cursor:"pointer",padding:"12px",display:"inline-flex",alignItems:"center",justifyContent:"center",fontSize:18,verticalAlign:"middle","&:hover":{color:t.colorPrimaryTextHover}}})),_e=({overlayClassName:t,overlay:n,hidden:s,children:a,...i})=>{if(s)return e.jsx(e.Fragment,{});const{styles:r}=Re();return e.jsx(O,{dropdownRender:n,overlayClassName:ee(r.container,t),...i,children:e.jsx("span",{className:r.iconStyle,children:a})})},De=()=>e.jsxs("svg",{viewBox:"0 0 24 24",focusable:"false",width:"1em",height:"1em",fill:"currentColor","aria-hidden":"true",children:[e.jsx("path",{d:"M0 0h24v24H0z",fill:"none"}),e.jsx("path",{d:"M12.87 15.07l-2.54-2.51.03-.03c1.74-1.94 2.98-4.17 3.71-6.53H17V4h-7V2H8v2H1v1.99h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11.76-2.04zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2l-4.5-12zm-2.62 7l1.62-4.33L19.12 17h-3.24z ",className:"css-c4d79v"})]}),Me=N(()=>({menuItemStyle:{minWidth:"160px"},menuItemIconStyle:{marginRight:"8px"}})),Ee=[{lang:"en-US",label:"English",icon:"ğŸ‡ºğŸ‡¸"},{lang:"sv-SE",label:"Svenska",icon:"ğŸ‡¸ğŸ‡ª"},{lang:"ar-AE",label:"Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©",icon:"ğŸ‡¦ğŸ‡ª"},{lang:"de-DE",label:"Deutsch",icon:"ğŸ‡©ğŸ‡ª"},{lang:"es-ES",label:"EspaÃ±ol",icon:"ğŸ‡ªğŸ‡¸"},{lang:"fr-FR",label:"FranÃ§ais",icon:"ğŸ‡«ğŸ‡·"},{lang:"zh-CN",label:"ä¸­æ–‡",icon:"ğŸ‡¨ğŸ‡³"}],tt=({transformLangConfig:t=n=>n})=>{const{i18n:n}=b(),{styles:s}=Me(),a=r=>{n.changeLanguage(r)},i={selectedKeys:[n.language],onClick:r=>{a(r.key)},items:t(Ee).map(r=>({key:r.lang,className:s.menuItemStyle,label:e.jsxs(e.Fragment,{children:[e.jsx("span",{role:"img","aria-label":(r==null?void 0:r.label)||"en-US",className:s.menuItemIconStyle,children:(r==null?void 0:r.icon)||"ğŸŒ"}),(r==null?void 0:r.label)||"en-US"]})}))};return e.jsx(_e,{menu:i,children:e.jsx(De,{})})},$e=N(({css:t})=>({avatarItem:t`
    :hover {
      background: rgba(0, 0, 0, 0.12);
    }
    padding: 5px;
  `})),Z=t=>ne.isString(t)&&t.match(/^[-_a-zA-Z0-9]+$/)?E.endsWith("/")?E+`files/${t}`:E+`/files/${t}`:t,Ve=({src:t,...n})=>e.jsx(te,{src:Z(t),...n}),Be=({onChange:t,shape:n="square"})=>{const[s,a]=d.useState([]),{styles:i}=$e(),[r,u]=d.useState(!1),[l,p]=d.useState(!0),[f,y]=d.useState(0),{run:c,loading:m}=z(()=>v.base.listFiles({current:f+1,page_size:40,file_type:"avatar",access:"public",search:""}),{manual:!0,onSuccess:({data:o})=>{a([...s,...o]),p(o.length===40),y(f+1)}}),w=()=>{p(!0),y(0),a([])};return e.jsx(re,{style:{zIndex:1e3},onOpenChange:o=>{u(o),o?c():w()},open:r,content:e.jsx("div",{style:{width:360,height:200},children:e.jsx("div",{id:"iconsScrollableDiv",style:{height:"100%",overflow:"auto"},children:e.jsx(oe,{dataLength:s.length,next:()=>{c()},hasMore:l,loader:e.jsx(ce,{avatar:!0,paragraph:{rows:1},active:!0}),endMessage:e.jsx(G,{plain:!0,children:"End"}),scrollableTarget:"iconsScrollableDiv",children:e.jsx(le,{grid:{gutter:16,column:8},dataSource:s,style:{margin:"0 8px"},loading:m,renderItem:({id:o})=>e.jsx("div",{className:i.avatarItem,onClick:g=>{g.stopPropagation(),t==null||t(o),u(!1),w()},children:e.jsx(Ve,{shape:n,src:o})})})})})}),placement:"bottom",trigger:"hover",children:e.jsx(ie,{shape:n,style:{width:112,height:112,placeContent:"center"}})})},Ne=({value:t,onChange:n,shape:s,...a})=>{const[i,r]=d.useState(void 0),[u,l]=d.useState(!1),[p,f]=d.useState(void 0),y=async c=>{l(!0),f(c.url??c.preview)};return d.useEffect(()=>{r(t?{uid:t,name:t,url:Z(t)}:void 0)},[t]),e.jsxs(e.Fragment,{children:[e.jsx(se,{beforeCrop:async c=>{if(c.type==="image/svg+xml"){const m=await v.base.uploadFile({type:"avatar"},c);return m.length>0&&(n==null||n(m[0].id)),!1}return!0},children:e.jsx(ae,{customRequest:async c=>{var w,o;const m=await v.base.uploadFile({type:"avatar",access:"public"},c.file);m.length>0?((w=c.onSuccess)==null||w.call(c,m[0].id),n==null||n(m[0].id)):(o=c.onError)==null||o.call(c,new Error("Upload file failed"))},listType:"picture-card",onPreview:y,maxCount:1,onChange:({file:c})=>{switch(c.status){case"removed":n==null||n(void 0);break;case"done":break;default:r(c);break}},fileList:i?[i]:[],...a,children:i?void 0:e.jsx(Be,{shape:s,onChange:n})})}),e.jsx(U,{open:u,footer:null,onCancel:()=>l(!1),children:e.jsx("img",{style:{width:"100%"},src:p})})]})},Ue=de,qe=t=>Ue[t],st=({iconName:t})=>{if(!t)return null;const n=qe(t);return n?e.jsx(d.Suspense,{fallback:null,children:e.jsx(n,{})}):null},at=({onSuccess:t,token:n})=>{const{t:s}=b("authorization"),{t:a}=b("common"),[i]=x.useForm(),{run:r,loading:u}=z(async l=>v.authorization.changePassword(l,n?{headers:{Authorization:`Bearer ${n}`}}:{}),{manual:!0,onSuccess:()=>{j.success(s("user.passwordChanged")),i.resetFields(),t==null||t()},onError:l=>{if(l instanceof ze){const p=l.code??"normal";j.error(s(`user.passwordChangeFailed.${p}`,{error:l.message,defaultValue:"Password change failed: {{error}}"}))}else j.error(s("user.passwordChangeFailed.normal",{error:l.message,defaultValue:"Password change failed: {{error}}"}));console.error("Failed to change password:",l)}});return e.jsxs(x,{form:i,layout:"vertical",onFinish:r,style:{maxWidth:500,margin:"0 auto"},children:[e.jsx(x.Item,{name:"old_password",label:s("user.oldPassword"),rules:[{required:!0,message:s("validation.oldPasswordRequired")}],children:e.jsx(A.Password,{})}),e.jsx(x.Item,{name:"new_password",label:s("user.newPassword"),rules:[{required:!0,message:s("validation.newPasswordRequired")},{min:8,message:s("validation.passwordMinLength")}],children:e.jsx(A.Password,{})}),e.jsx(x.Item,{name:"confirm_password",label:s("user.confirmPassword"),rules:[{required:!0,message:s("validation.confirmPasswordRequired")},({getFieldValue:l})=>({validator(p,f){return!f||l("new_password")===f?Promise.resolve():Promise.reject(new Error(s("validation.passwordMismatch")))}})],children:e.jsx(A.Password,{})}),e.jsx(x.Item,{children:e.jsx(S,{type:"primary",htmlType:"submit",loading:u,children:a("save")})})]})},nt=({user:t,onSuccess:n})=>{const{t:s}=b("authorization"),{t:a}=b("common"),[i]=x.useForm(),[r,u]=d.useState(!1);ue.useEffect(()=>{t&&i.setFieldsValue({username:t.username,email:t.email,full_name:t.full_name,phone:t.phone||"",avatar:t.avatar})},[t,i]);const l=async p=>{try{u(!0),await v.authorization.updateCurrentUser(p),j.success(a("updateSuccess")),n()}catch(f){j.error(a("updateFailed")),console.error("Failed to update user information:",f)}finally{u(!1)}};return e.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center"},children:[e.jsxs("div",{style:{marginBottom:24,textAlign:"center"},children:[e.jsx("h2",{children:(t==null?void 0:t.full_name)||(t==null?void 0:t.username)}),(t==null?void 0:t.roles)&&t.roles.length>0&&e.jsxs("div",{children:[s("user.roles"),": ",t.roles.map(p=>p.name).join(", ")]})]}),e.jsxs(x,{form:i,layout:"vertical",onFinish:l,style:{width:"100%",maxWidth:500},children:[e.jsx(x.Item,{style:{marginBottom:24,textAlign:"center",justifyItems:"center"},name:"avatar",children:e.jsx(Ne,{})}),e.jsx(x.Item,{name:"username",label:s("user.username"),children:e.jsx(A,{disabled:!0})}),e.jsx(x.Item,{name:"email",label:s("user.email"),rules:[{required:!0,message:s("validation.emailRequired")},{type:"email",message:s("validation.emailInvalid")}],children:e.jsx(A,{})}),e.jsx(x.Item,{name:"full_name",label:s("user.fullName"),rules:[{required:!0,message:s("validation.fullNameRequired")}],children:e.jsx(A,{})}),e.jsx(x.Item,{name:"phone",label:s("user.phone"),children:e.jsx(A,{})}),e.jsx(x.Item,{children:e.jsx(S,{type:"primary",htmlType:"submit",loading:r,children:a("save")})})]})]})},rt=({user:t,onSuccess:n})=>{const{t:s}=b("authorization"),{t:a}=b("common"),[i,r]=d.useState(0),[u,l]=d.useState(!1),[p,f]=d.useState(!0),[y,c]=d.useState(""),[m,w]=d.useState("totp"),{run:o,data:g={secret:"",qr_code:"",token:void 0}}=z(()=>v.authorization.enableMfa(m),{manual:!0,onSuccess:()=>{r(1)},onBefore:()=>{l(!0)},onFinally:()=>{l(!1)}}),M=async()=>{if(!y){j.warning(s("mfa.enterVerificationCode"));return}const I={code:y,mfa_type:m};"token"in g&&(I.token=g.token);try{l(!0),await v.authorization.verifyAndActivateMfa(I),j.success(s("mfa.enableSuccess")),r(2),n()}catch(k){j.error(s("mfa.verificationFailed")),console.error("Failed to verify MFA:",k)}finally{l(!1)}},h=async()=>{try{l(!0),await v.authorization.disableMfa(),j.success(s("mfa.disableSuccess")),n()}catch(I){j.error(a("operationFailed")),console.error("Failed to disable MFA:",I)}finally{l(!1)}},F=()=>{if(!t)return null;if(t.mfa_enabled)return e.jsx(K,{status:"success",title:s("mfa.enabled"),subTitle:s("mfa.enabledDescription"),extra:e.jsx(S,{danger:!0,onClick:()=>{U.confirm({title:s("mfa.confirmDisable"),content:s("mfa.disableWarning"),onOk:h,okButtonProps:{danger:!0}})},children:s("mfa.disable")})});const I=()=>{var k;switch(i){case 0:return e.jsxs("div",{style:{textAlign:"center",marginTop:20},children:[e.jsx(W,{message:e.jsxs("div",{children:[e.jsx("p",{children:s("mfa.setupInfo")}),e.jsx("p",{children:s(m==="totp"?"mfa.totpDescription":"mfa.emailDescription")})]}),type:"info",showIcon:!0,style:{marginBottom:20}}),e.jsx(S,{type:"primary",onClick:o,loading:u,children:s("mfa.startSetup")})]});case 1:return e.jsxs("div",{style:{textAlign:"center",marginTop:20},children:[e.jsx(W,{message:s("mfa.scanQrCode"),type:"info",showIcon:!0,style:{marginBottom:20,display:m==="totp"?"block":"none"}}),e.jsx("div",{style:{display:m==="totp"?"flex":"none",justifyContent:"center",marginBottom:24},children:e.jsx(xe,{value:g.qr_code??"",size:200})}),e.jsx("div",{style:{marginBottom:16,display:m==="email"?"block":"none"},children:e.jsxs("p",{children:[s("user.email"),": ",e.jsx("strong",{children:t==null?void 0:t.email})]})}),e.jsx("div",{style:{marginBottom:16,display:m==="totp"?"block":"none"},children:e.jsxs("p",{children:[s("mfa.secretKey"),": ",e.jsx("strong",{children:p?"*".repeat(((k=g.secret)==null?void 0:k.length)??0):g.secret}),e.jsx(S,{type:"link",onClick:()=>f(!p),icon:p?e.jsx(J,{}):e.jsx(ge,{})})]})}),e.jsx("div",{style:{marginBottom:24},children:e.jsx(A,{placeholder:s("mfa.enterCode"),style:{width:200},maxLength:6,value:y,onChange:P=>c(P.target.value)})}),e.jsxs(L,{children:[e.jsx(S,{onClick:()=>r(0),children:a("previous")}),e.jsx(S,{type:"primary",onClick:M,loading:u,children:a("verify")})]})]});case 2:return e.jsx(K,{status:"success",title:s("mfa.setupSuccess"),subTitle:s("mfa.setupSuccessDescription"),extra:e.jsx(S,{type:"primary",onClick:()=>r(0),children:a("done")})});default:return null}};return e.jsxs("div",{children:[e.jsxs("div",{style:{display:i===2?"none":"unset"},children:[e.jsx(me,{defaultValue:"totp",onChange:k=>{w(k),r(0)},value:m,options:[{value:"totp",icon:e.jsx(he,{}),label:s("mfa.totp",{defaultValue:"TOTP"})},{value:"email",icon:e.jsx(pe,{}),label:s("mfa.email",{defaultValue:"E-Mail"})}]}),e.jsx(G,{})]}),e.jsx(fe,{current:i,items:[{title:s(m==="totp"?"mfa.totpStep1":"mfa.emailStep1"),description:s(m==="totp"?"mfa.totpStep1Description":"mfa.emailStep1Description")},{title:s(m==="totp"?"mfa.totpStep2":"mfa.emailStep2"),description:s(m==="totp"?"mfa.totpStep2Description":"mfa.emailStep2Description")},{title:s(m==="totp"?"mfa.totpStep3":"mfa.emailStep3"),description:s(m==="totp"?"mfa.totpStep3Description":"mfa.emailStep3Description")}],style:{marginBottom:30}}),I()]})};return e.jsx(_,{title:s("mfa.title"),children:F()})},{Text:$}=ye,it=()=>{const{t}=b("authorization"),{t:n}=b("common"),[s,a]=d.useState([]),[i,r]=d.useState(!1),[u,l]=d.useState(null),[p,f]=d.useState(!1),y=async()=>{try{r(!0);const o=await v.authorization.getUserSessions({});a(o)}catch(o){j.error(t("session.getSessionsFailed",{error:o,defaultValue:"Failed to get session list: {{error}}"}))}finally{r(!1)}};d.useEffect(()=>{y()},[]);const c=async o=>{try{l(o),await v.authorization.terminateSession({id:o}),a(s.filter(g=>g.id!==o)),j.success(t("session.terminateSuccess",{defaultValue:"Session terminated successfully"}))}catch(g){j.error(t("session.terminateFailed",{error:g,defaultValue:"Failed to terminate session: {{error}}"}))}finally{l(null)}},m=async()=>{try{f(!0),await v.authorization.terminateOtherSessions(),a(s.filter(o=>o.is_current)),j.success(t("session.terminateAllSuccess",{defaultValue:"All other sessions terminated successfully"}))}catch(o){j.error(t("session.terminateAllFailed",{error:o,defaultValue:"Failed to terminate all other sessions: {{error}}"}))}finally{f(!1)}},w=[{title:t("session.device"),dataIndex:"user_agent",key:"device",render:(o,g)=>e.jsxs(L,{direction:"vertical",size:0,children:[e.jsxs(L,{children:[e.jsx(je,{}),e.jsx($,{strong:!0,children:o})]}),e.jsxs(L,{children:[e.jsx(Se,{}),e.jsx($,{type:"secondary",children:g.location})]})]})},{title:t("session.ipAddress"),dataIndex:"ip_address",key:"ip_address",render:o=>e.jsxs(L,{children:[e.jsx(ve,{}),e.jsx("span",{children:o})]})},{title:t("session.lastActive"),dataIndex:"last_active_at",key:"last_active",render:o=>e.jsxs(L,{children:[e.jsx(we,{}),e.jsx("span",{children:new Date(o).toLocaleString()})]})},{title:t("session.status"),key:"status",render:o=>o.is_current?e.jsx(D,{color:"green",children:t("session.current")}):e.jsx(D,{color:"blue",children:t("session.active")})},{title:n("actions"),key:"action",render:o=>o.is_current?e.jsx($,{type:"secondary",children:t("session.currentSession")}):e.jsx(V,{title:t("session.confirmTerminate"),onConfirm:()=>c(o.id),okText:n("confirm"),cancelText:n("cancel"),children:e.jsx(S,{type:"link",danger:!0,loading:u===o.id,children:t("session.terminate")})})}];return e.jsx(_,{title:t("session.title"),extra:s.length>1&&e.jsx(V,{title:t("session.confirmTerminateAll"),onConfirm:m,okText:n("confirm"),cancelText:n("cancel"),children:e.jsx(S,{danger:!0,loading:p,children:t("session.terminateOthers")})}),children:s.length===0?e.jsx(Ie,{description:t("session.noSessions")}):e.jsx(q,{columns:w,dataSource:s,rowKey:"id",loading:i,pagination:!1})})},{RangePicker:He}=be,{Option:C}=B,Ke=t=>t||"N/A",We=(t,n)=>t==="success"?e.jsx(D,{color:"success",children:n("statuses.success")}):e.jsx(D,{color:"error",children:n("statuses.failed")}),ot=({userId:t,request:n=a=>t?v.authorization.getUserLogs({id:t,...a}):v.authorization.getCurrentUserLogs(a),columnsFilter:s=a=>a})=>{const{t:a}=b("authorization"),{t:i}=b("common"),[r,u]=d.useState({current:1,pageSize:10,total:0}),[l,p]=d.useState({}),[f]=x.useForm(),{loading:y,run:c,data:{data:m}={}}=z(async(h=l,F=1,I=10)=>n({...h,current:F??1,page_size:I??10}),{onError(h){j.error(a("auditLog.fetchFailed",{error:h}))},onSuccess({total:h}){u({...r,total:h})}});d.useEffect(()=>{c(l,1,r.pageSize)},[]);const w=h=>{u({...r,current:h.current,pageSize:h.pageSize}),c({},h.current,h.pageSize)},o=h=>{var F,I,k,P;c({...h,start_time:(I=(F=h.dateRange)==null?void 0:F[0])==null?void 0:I.toISOString(),end_time:(P=(k=h.dateRange)==null?void 0:k[1])==null?void 0:P.toISOString()},1,r.pageSize)},g=()=>{f.resetFields(),p({}),u({...r,current:1}),c({},1,r.pageSize)},M=[{title:a("auditLog.timestamp"),dataIndex:"timestamp",key:"timestamp",render:h=>Te(h)},{title:a("auditLog.action"),dataIndex:"action",key:"action",render:(h,F)=>h?a(`action.${h.replace(":",".")}`,{defaultValue:F.action_name}):F.action_name??F.action},{title:a("auditLog.user_agent"),dataIndex:"user_agent",key:"user_agent"},{title:a("auditLog.ip"),dataIndex:"ip",key:"ip",render:h=>Ke(h)},{title:a("auditLog.status"),dataIndex:"status",key:"status",render:h=>We(h,a)},{title:a("auditLog.details"),dataIndex:"details",key:"details",render:h=>e.jsx(S,{type:"link",icon:e.jsx(J,{}),onClick:()=>{U.info({title:a("auditLog.details"),content:JSON.stringify(h)})}})}];return e.jsxs("div",{children:[e.jsx(_,{style:{marginBottom:16},children:e.jsxs(x,{form:f,layout:"horizontal",onFinish:o,initialValues:l,children:[e.jsxs(Q,{gutter:24,children:[e.jsx(T,{span:6,children:e.jsx(x.Item,{name:"search",label:a("auditLog.search"),children:e.jsx(A,{placeholder:a("auditLog.searchPlaceholder")})})}),e.jsx(T,{span:6,children:e.jsx(x.Item,{name:"action",label:a("auditLog.action"),children:e.jsxs(B,{allowClear:!0,placeholder:a("auditLog.selectAction"),children:[e.jsx(C,{value:"login",children:a("actions.login")}),e.jsx(C,{value:"logout",children:a("actions.logout")}),e.jsx(C,{value:"password_reset",children:a("actions.passwordReset")}),e.jsx(C,{value:"mfa_change",children:a("actions.mfaChange")})]})})}),e.jsx(T,{span:6,children:e.jsx(x.Item,{name:"status",label:a("auditLog.status"),children:e.jsxs(B,{allowClear:!0,placeholder:a("auditLog.selectStatus"),children:[e.jsx(C,{value:"success",children:a("statuses.success")}),e.jsx(C,{value:"failed",children:a("statuses.failed")})]})})}),e.jsx(T,{span:6,children:e.jsx(x.Item,{name:"dateRange",label:a("auditLog.dateRange"),children:e.jsx(He,{style:{width:"100%"}})})})]}),e.jsx(Q,{children:e.jsx(T,{span:24,style:{textAlign:"right"},children:e.jsxs(L,{children:[e.jsx(S,{onClick:g,children:i("reset")}),e.jsx(S,{type:"primary",htmlType:"submit",icon:e.jsx(Fe,{}),children:i("search")})]})})})]})}),e.jsxs(_,{children:[e.jsx("div",{style:{marginBottom:16},children:e.jsx(S,{type:"primary",icon:e.jsx(ke,{}),onClick:g,style:{marginRight:8},children:i("refresh")})}),e.jsx(q,{rowKey:"id",columns:s(M),dataSource:m,pagination:{...r,showSizeChanger:!0,showTotal:h=>i("totalItems",{total:h})},loading:y,onChange:w,scroll:{x:"max-content"}})]})]})},Qe=({permission:t,permissions:n=[],checkAll:s=!1,fallback:a=null,children:i})=>{const{hasPermission:r,hasAnyPermission:u,hasAllPermissions:l,isAdmin:p,loading:f}=X();return f?null:p?e.jsx(e.Fragment,{children:i}):t?r(t)?e.jsx(e.Fragment,{children:i}):e.jsx(e.Fragment,{children:a}):n.length>0?(s?l(n):u(n))?e.jsx(e.Fragment,{children:i}):e.jsx(e.Fragment,{children:a}):e.jsx(e.Fragment,{children:i})},R=t=>{const{permission:n,icon:s,tooltip:a,onClick:i,confirm:r,...u}=t;return n?e.jsx(Qe,{permission:n,children:R({icon:s,tooltip:a,onClick:i,confirm:r,...u})},t.key):r?e.jsx(V,{title:r.title,onConfirm:r.onConfirm||i,okText:r.okText,cancelText:r.cancelText,children:R({icon:s,tooltip:a,...u})},t.key):a?e.jsx(Ae,{title:a,children:R({icon:s,onClick:i,...u})},t.key):d.createElement(S,{type:"text",size:"small",icon:s,onClick:i,...u,key:t.key})},lt=({actions:t})=>t.filter(n=>!n.hidden).map(n=>R(n)),Ge=({request:t,tableRef:n,...s},a)=>{const[i,r]=d.useState({current:1,pageSize:10}),[u,l]=d.useState(0),{data:p,loading:f,refresh:y}=z(async()=>{const c=await t({current:i.current,page_size:i.pageSize});return l(c.total),c.data},{refreshDeps:[i]});return d.useImperativeHandle(a,()=>({reload:()=>{y()}})),e.jsx(q,{rowKey:"id",loading:f,dataSource:p??[],pagination:{...i,total:u,onChange:(c,m)=>{r({current:c,pageSize:m})}},...s,ref:n})},ct=({actionRef:t,...n})=>{const[s,a]=d.useState();return d.useEffect(()=>{a(d.forwardRef(Ge))},[]),s?e.jsx(s,{...n,ref:t}):null};export{Ve as A,st as D,_e as H,Pe as L,et as P,ct as T,ot as U,tt as a,at as b,nt as c,rt as d,it as e,Qe as f,Ee as g,lt as h,Ne as i};
