const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dashboard.BJz5qZZq.js","assets/vendor.BL40-5vE.js","assets/vite.BF1G3H_w.js","assets/vendor.D-Ncpkvi.css","assets/contexts.Dt3wwJ0J.js","assets/client.DDakgimh.js","assets/base.D4vFg2QQ.js","assets/components.Dud8GRKo.js","assets/authorization.BQlZIvgA.js","assets/system.BRbvWX2z.js","assets/oauth.DArpXUFq.js","assets/login.CCQaCCp4.js","assets/profile.BamlxPkY.js","assets/not_found.D8SvSEXl.js","assets/forbidden.CD6MANDV.js","assets/users.DBdZRiYD.js","assets/roles.B79uF9_B.js","assets/system-settings.DPPlMSQ6.js","assets/audit.CsTrs-jU.js","assets/service-accounts.BUr9eNLV.js"])))=>i.map(i=>d[i]);
import{_ as u}from"./vite.BF1G3H_w.js";import{r as n,j as e,ad as te,ae,af as $,ag as ne,ah as ie,ai as se,aj as T,ak as D,u as k,al as oe,ac as re,am as P,an as le,ao as ce,ap as ue,aq as de,S as he,n as me,ar as pe,as as _e,at as fe,au as xe,av as ge,aw as ve,ax as ye,ay as je,az as ze,aA as N,aB as Ee,aC as Re,aD as Le,aE as Ae,aF as Ie,aG as F,aH as we}from"./vendor.BL40-5vE.js";import{L as be,H,A as M,a as Se,P as Pe}from"./components.Dud8GRKo.js";import{a as $e,u as De,A as Oe}from"./contexts.Dt3wwJ0J.js";import{a as Ve}from"./authorization.BQlZIvgA.js";import{b as Te,g as Q}from"./base.D4vFg2QQ.js";import{s as ke}from"./system.BRbvWX2z.js";import{o as Ne}from"./oauth.DArpXUFq.js";import"./index.CFGX7lSC.js";import"./client.DDakgimh.js";const Be=n.lazy(()=>u(()=>import("./dashboard.BJz5qZZq.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),Ce=n.lazy(()=>u(()=>import("./login.CCQaCCp4.js"),__vite__mapDeps([11,1,2,3,4,5,6,7,8,9,10]))),Fe=n.lazy(()=>u(()=>import("./profile.BamlxPkY.js"),__vite__mapDeps([12,1,2,3,7,4,5,6,8,9,10]))),U=n.lazy(()=>u(()=>import("./not_found.D8SvSEXl.js"),__vite__mapDeps([13,1,2,3]))),He=n.lazy(()=>u(()=>import("./forbidden.CD6MANDV.js"),__vite__mapDeps([14,1,2,3]))),Me=n.lazy(()=>u(()=>import("./users.DBdZRiYD.js").then(o=>o.U),__vite__mapDeps([15,1,2,3,7,4,5,6]))),Ue=n.lazy(()=>u(()=>import("./users.DBdZRiYD.js").then(o=>o.a),__vite__mapDeps([15,1,2,3,7,4,5,6]))),q=n.lazy(()=>u(()=>import("./users.DBdZRiYD.js").then(o=>o.b),__vite__mapDeps([15,1,2,3,7,4,5,6]))),qe=n.lazy(()=>u(()=>import("./roles.B79uF9_B.js"),__vite__mapDeps([16,1,2,3,7,4,5,6,8,9,10]))),Ke=n.lazy(()=>u(()=>import("./system-settings.DPPlMSQ6.js").then(o=>o.i),__vite__mapDeps([17,1,2,3,6,5,7,4]))),Qe=n.lazy(()=>u(()=>import("./system-settings.DPPlMSQ6.js").then(o=>o.O),__vite__mapDeps([17,1,2,3,6,5,7,4]))),Ge=n.lazy(()=>u(()=>import("./audit.CsTrs-jU.js"),__vite__mapDeps([18,1,2,3,7,4,5,6,8,9,10]))),We=n.lazy(()=>u(()=>import("./service-accounts.BUr9eNLV.js").then(o=>o.S),__vite__mapDeps([19,1,2,3,7,4,5,6,13]))),Ye=n.lazy(()=>u(()=>import("./service-accounts.BUr9eNLV.js").then(o=>o.a),__vite__mapDeps([19,1,2,3,7,4,5,6,13])));function l(o,h){return e.jsx(n.Suspense,{fallback:e.jsx(be,{}),children:e.jsx(o,{...h})})}const Je=({transformSettingTabs:o,transformLangConfig:h,extraPrivateRoutes:g=[],extraPublicRoutes:v=[]})=>{const y=[{path:"/login",element:l(Ce,{transformLangConfig:h}),index:!0},{path:"/404",element:l(U),index:!0},{path:"/403",element:l(He),index:!0},{path:"/system/settings/oauth/test-callback",element:l(Qe),index:!0},...v],j=[{path:"/",is_private:!0,children:[{path:"/",element:l(Be),name:"dashboard",icon:e.jsx(te,{}),index:!0},{path:"/profile",element:l(Fe),name:void 0,index:!0},{name:"authorization",icon:e.jsx($,{}),permissions:["authorization:user:view","authorization:user:create","authorization:user:update","authorization:user:delete","authorization:service_account:view","authorization:service_account:create","authorization:service_account:update","authorization:service_account:delete"],children:[{path:"/authorization/roles",name:"roles",icon:e.jsx(ae,{}),permissions:["authorization:role:view","authorization:role:create","authorization:role:update","authorization:role:delete"],children:[{element:l(qe),permissions:["authorization:role:view"],index:!0}]},{path:"/authorization/users",name:"users",icon:e.jsx($,{}),permissions:["authorization:user:view","authorization:user:list","authorization:user:create","authorization:user:update","authorization:user:delete"],children:[{element:l(Me),permissions:["authorization:user:list"],index:!0},{path:"/authorization/users/create",element:l(q),permissions:["authorization:user:create"],index:!0},{path:"/authorization/users/:id",element:l(Ue),permissions:["authorization:user:view"],index:!0},{path:"/authorization/users/:id/edit",element:l(q),permissions:["authorization:user:update"],index:!0}]},{path:"/authorization/service-accounts",name:"serviceAccounts",icon:e.jsx($,{}),permissions:["authorization:service_account:view"],children:[{element:l(We),permissions:["authorization:service_account:view"],index:!0},{path:"/authorization/service-accounts/:id",element:l(Ye),permissions:["authorization:service_account:view"],index:!0}]}]},...g,{name:"system",icon:e.jsx(se,{}),permissions:["system:settings:view","system:settings:update","system:audit:view"],children:[{path:"/system/settings",icon:e.jsx(ne,{}),index:!0,name:"settings",permissions:["system:settings:view","system:settings:update"],element:l(Ke,{transformItems:o})},{path:"/system/audit",icon:e.jsx(ie,{}),name:"audit",permissions:["system:audit:view"],index:!0,element:l(Ge)}]},{path:"*",element:l(U),index:!0}]}];return[...y,...j]},Xe={authorization:Ve,base:Te,system:ke,oauth:Ne},{Header:Ze,Content:et,Footer:tt,Sider:at}=T,{SubMenu:nt}=D,it=({element:o,routes:h,transformLangConfig:g,menuStyle:v="dark",transformHeaderItems:y=m=>m,renderLayout:j})=>{const{t:m,i18n:z}=k(),{t:c}=k("common"),[E,I]=n.useState(!1),f=oe(),{hasPermission:w}=$e(),R=re(),{logout:L,user:i}=De(),[s,A]=n.useState([]),[b,S]=n.useState(null),[O,G]=n.useState("Loading..."),[x,W]=n.useState(null);f.pathname!=="/profile"&&(i&&i.mfa_enforced&&!i.mfa_enabled?R("/profile#mfa"):i&&i.status==="password_expired"&&R("/profile#password"));const Y=()=>{L(),window.location.href=Q("/login?redirect="+encodeURIComponent(window.location.href))},J=[{key:"profile",label:e.jsx(P,{to:"/profile",children:c("profile")})},{key:"logout",label:c("logout"),onClick:Y}];n.useEffect(()=>{Xe.system.getSiteConfig().then(a=>{var t;const r=a.navigation.filter(d=>d.path!==a.home_page),_=[...a.home_page?[{name:"home",path:a.home_page}]:[],...r];_.length>1?A(_):A([]),S(a.logo),W(a),(t=document.getElementById("site-icon"))==null||t.setAttribute("href",a.logo)})},[]),n.useEffect(()=>{z.language&&G((x==null?void 0:x.name_i18n[z.language])||(x==null?void 0:x.name)||"")},[x,z.language]);const V=()=>{const a=de(h,f.pathname),r=[];if(a){for(const[_,t]of a.entries())if(t.route.path==="/"&&!t.route.name)r.push({href:t.route.path,title:c("home"),key:"home"});else if(t.route.name){const d=a.slice(0,_+1).map(p=>p.route.name).filter(Boolean).join(".");r.push({path:t.route.path,title:t.route.name?m(`breadcrumbs.${d}`):void 0,key:t.route.path})}}return r},X=a=>a.some(r=>w(r)),Z=le.flatMapDeep(h,a=>a.children).map(a=>a==null?void 0:a.name).filter(a=>a!==void 0),B=(a,r=[])=>{const _=t=>t&&t.replace(/_/g," ").split(" ").map(d=>d.charAt(0).toUpperCase()+d.slice(1)).join(" ");return a.flatMap(t=>"children"in t&&t.children&&!t.name?t.children:[t]).map(t=>{if(t.permissions&&!X(t.permissions))return null;const d=_(t.name);if(!t.name)return null;if("children"in t&&t.children){const p=B(t.children,[...r,t.name]);return p.length==0&&t.path?e.jsx(D.Item,{icon:t.icon,children:e.jsx(P,{to:t.path,children:m(`menu.${[...r,t.name].join(".")}`,{defaultValue:d})})},t.path):e.jsx(nt,{icon:t.icon,title:m(`menu.${[...r,t.name,t.name].join(".")}`,{defaultValue:d}),children:p},t.path??t.name)}return t.name&&t.path?e.jsx(D.Item,{icon:t.icon,children:e.jsx(P,{to:t.path,children:m(`menu.${[...r,t.name].join(".")}`,{defaultValue:d})})},t.path):null}).filter(Boolean)};n.useEffect(()=>{const a=V().filter(r=>r.path!=="/").map(r=>r.title).join(" - ");a?document.title=`${O} | ${a}`:document.title=O},[V,f.pathname]);const ee=[e.jsx(H,{hidden:s.length<=1,menu:{items:s.map(a=>({key:a.path,style:{paddingRight:"20px"},label:e.jsx("a",{href:a.path,children:m(`menu.${a.name}`,{defaultValue:a.name})})}))},children:e.jsx(ce,{})}),e.jsxs(H,{menu:{items:J},children:[i!=null&&i.avatar?e.jsx(M,{src:i.avatar}):e.jsx(M,{icon:e.jsx($,{})}),e.jsx("span",{style:{height:"1em",lineHeight:"1em",marginLeft:"5px"},children:(i==null?void 0:i.full_name)||(i==null?void 0:i.username)})]}),e.jsx(Se,{transformLangConfig:g})];return(j??((a,r,_,t,d)=>e.jsxs(T,{style:{minHeight:"100vh"},children:[e.jsxs(at,{collapsible:!0,collapsed:E,onCollapse:I,theme:v,children:[e.jsx("div",{className:"logo",style:{margin:"8px",display:"flex"},children:e.jsx("div",{style:{width:"100%",height:"100%",textAlign:"center"},children:a?e.jsx("img",{src:a,alt:"logo",style:{height:"32px",width:"32px"}}):e.jsx(he,{size:"large",tip:"Loading..."})})}),e.jsx(D,{theme:v,defaultOpenKeys:Z,defaultSelectedKeys:["1"],mode:"inline",selectedKeys:[f.pathname],children:r})]}),e.jsxs(T,{className:"site-layout",children:[e.jsxs(Ze,{className:"site-layout-background",style:{padding:0,display:"flex",justifyContent:"space-between"},children:[e.jsx(me,{type:"text",icon:E?e.jsx(pe,{}):e.jsx(_e,{}),onClick:()=>I(!E),style:{fontSize:"16px",width:64,height:64}}),e.jsx("div",{style:{marginRight:"20px"},children:_})]}),e.jsxs(et,{style:{margin:"0 16px"},children:[e.jsx(fe,{style:{margin:"16px 0"},itemRender:p=>{const C=p.href||p.path;return C?e.jsx(P,{to:C,children:p.title}):e.jsx("span",{children:p.title})},items:t}),e.jsx("div",{className:"site-layout-background",style:{padding:24,minHeight:360},children:d})]}),e.jsxs(tt,{style:{textAlign:"center"},children:[" Â©",new Date().getFullYear()," ",O]})]})]})))(b,B(h),y(ee),V(),o??e.jsx(ue,{}))},st=new xe({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1}}}),K={"zh-CN":Ee,"en-US":N,"de-DE":ze,"es-ES":je,"fr-FR":ye,"ar-AE":ve,"sv-SE":ge};function ot({transformRouter:o=c=>c,transformSettingTabs:h=c=>c,transformLangConfig:g=c=>c,extraPrivateRoutes:v=[],extraPublicRoutes:y=[],menuStyle:j="dark",transformHeaderItems:m=c=>c,renderLayout:z}){const{i18n:c}=k(),[E,I]=n.useState(K[c.language]||N);n.useEffect(()=>{I(K[c.language]||N)},[c.language]);const f=L=>L.map(i=>i.children===void 0?i:{...i,children:f(i.children)}),w=o(f(Je({transformSettingTabs:h,transformLangConfig:g,extraPrivateRoutes:v,extraPublicRoutes:y}))),R=(L,i)=>L.flatMap(s=>s.is_private?[s]:"children"in s&&s.children?s.children:[s]).map((s,A)=>{const b=s.is_private?e.jsx(Pe,{element:e.jsx(it,{routes:w,element:s.element,transformLangConfig:g,menuStyle:j,transformHeaderItems:m,renderLayout:z})}):s.element;if("children"in s&&s.children&&s.children.length>0)return e.jsx(F,{path:s.path,element:b,children:R(s.children,s)},s.path??s.name??A);const{path:S}=s;return e.jsx(F,{path:S,index:s.index,element:b},S??s.name??`${(i==null?void 0:i.path)??""}.${A}`)}).filter(Boolean);return e.jsx(Re,{client:st,children:e.jsx(Le,{locale:E,children:e.jsx(Oe,{children:e.jsx(Ae,{basename:Q(),children:e.jsx(Ie,{children:R(w)})})})})})}we.createRoot(document.getElementById("root")).render(e.jsx(ot,{}));export{Xe as a};
