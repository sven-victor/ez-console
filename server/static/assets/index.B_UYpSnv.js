const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dashboard.BWBA5HeT.js","assets/vendor.5VlR7AZZ.js","assets/vite.BF1G3H_w.js","assets/vendor.D-Ncpkvi.css","assets/contexts.04mB6OKD.js","assets/client.ByMSUD-z.js","assets/base.DcAVaXga.js","assets/components.CBXooEQS.js","assets/authorization.Cg-deZBc.js","assets/system.-kunYqu8.js","assets/oauth.BnK4wi7i.js","assets/login.A6B6gn2D.js","assets/profile.DtFwneWP.js","assets/not_found.DXHeq3fI.js","assets/forbidden.B9DJEbsH.js","assets/users.DqIeBMZD.js","assets/roles.CkZtWelf.js","assets/system-settings.h5ssoos2.js","assets/audit.CWeC5pOC.js","assets/service-accounts.Bckw3oFi.js"])))=>i.map(i=>d[i]);
import{_ as c}from"./vite.BF1G3H_w.js";import{r as n,j as e,ad as J,ae as X,af as S,ag as Z,ah as ee,ai as te,aj as O,ak as P,u as V,al as ae,ac as ne,am as b,an as ie,S as se,n as oe,ao as re,ap as le,aq as ce,ar as ue,as as he,at as de,au as me,av as pe,aw as _e,ax as fe,ay as xe,az as ge,aA as T,aB as ve,aC as je,aD as ye,aE as ze,aF as Ee,aG as N,aH as Re}from"./vendor.5VlR7AZZ.js";import{L as Ae,H as B,A as C,a as Ie,P as Le}from"./components.CBXooEQS.js";import{a as we,u as be,A as Se}from"./contexts.04mB6OKD.js";import{a as Pe}from"./authorization.Cg-deZBc.js";import{b as $e,g as M}from"./base.DcAVaXga.js";import{s as De}from"./system.-kunYqu8.js";import{o as Oe}from"./oauth.BnK4wi7i.js";import"./index.B_UYpSnv.js";import"./client.ByMSUD-z.js";const Ve=n.lazy(()=>c(()=>import("./dashboard.BWBA5HeT.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10]))),Te=n.lazy(()=>c(()=>import("./login.A6B6gn2D.js"),__vite__mapDeps([11,1,2,3,4,5,6,7,8,9,10]))),ke=n.lazy(()=>c(()=>import("./profile.DtFwneWP.js"),__vite__mapDeps([12,1,2,3,7,4,5,6,8,9,10]))),F=n.lazy(()=>c(()=>import("./not_found.DXHeq3fI.js"),__vite__mapDeps([13,1,2,3]))),Ne=n.lazy(()=>c(()=>import("./forbidden.B9DJEbsH.js"),__vite__mapDeps([14,1,2,3]))),Be=n.lazy(()=>c(()=>import("./users.DqIeBMZD.js").then(o=>o.U),__vite__mapDeps([15,1,2,3,7,4,5,6]))),Ce=n.lazy(()=>c(()=>import("./users.DqIeBMZD.js").then(o=>o.a),__vite__mapDeps([15,1,2,3,7,4,5,6]))),U=n.lazy(()=>c(()=>import("./users.DqIeBMZD.js").then(o=>o.b),__vite__mapDeps([15,1,2,3,7,4,5,6]))),Fe=n.lazy(()=>c(()=>import("./roles.CkZtWelf.js"),__vite__mapDeps([16,1,2,3,7,4,5,6,8,9,10]))),Ue=n.lazy(()=>c(()=>import("./system-settings.h5ssoos2.js").then(o=>o.i),__vite__mapDeps([17,1,2,3,6,5,7,4]))),He=n.lazy(()=>c(()=>import("./system-settings.h5ssoos2.js").then(o=>o.O),__vite__mapDeps([17,1,2,3,6,5,7,4]))),Me=n.lazy(()=>c(()=>import("./audit.CWeC5pOC.js"),__vite__mapDeps([18,1,2,3,7,4,5,6,8,9,10]))),qe=n.lazy(()=>c(()=>import("./service-accounts.Bckw3oFi.js").then(o=>o.S),__vite__mapDeps([19,1,2,3,7,4,5,6,13]))),Ke=n.lazy(()=>c(()=>import("./service-accounts.Bckw3oFi.js").then(o=>o.a),__vite__mapDeps([19,1,2,3,7,4,5,6,13])));function l(o,d){return e.jsx(n.Suspense,{fallback:e.jsx(Ae,{}),children:e.jsx(o,{...d})})}const Qe=({transformSettingTabs:o,transformLangConfig:d,extraPrivateRoutes:x=[],extraPublicRoutes:g=[]})=>{const m=[{path:"/login",element:l(Te,{transformLangConfig:d}),index:!0},{path:"/404",element:l(F),index:!0},{path:"/403",element:l(Ne),index:!0},{path:"/system/settings/oauth/test-callback",element:l(He),index:!0},...g],p=[{path:"/",is_private:!0,children:[{path:"/",element:l(Ve),name:"dashboard",icon:e.jsx(J,{}),index:!0},{path:"/profile",element:l(ke),name:void 0,index:!0},{name:"authorization",icon:e.jsx(S,{}),permissions:["authorization:user:view","authorization:user:create","authorization:user:update","authorization:user:delete","authorization:service_account:view","authorization:service_account:create","authorization:service_account:update","authorization:service_account:delete"],children:[{path:"/authorization/roles",name:"roles",icon:e.jsx(X,{}),permissions:["authorization:role:view","authorization:role:create","authorization:role:update","authorization:role:delete"],children:[{element:l(Fe),permissions:["authorization:role:view"],index:!0}]},{path:"/authorization/users",name:"users",icon:e.jsx(S,{}),permissions:["authorization:user:view","authorization:user:list","authorization:user:create","authorization:user:update","authorization:user:delete"],children:[{element:l(Be),permissions:["authorization:user:list"],index:!0},{path:"/authorization/users/create",element:l(U),permissions:["authorization:user:create"],index:!0},{path:"/authorization/users/:id",element:l(Ce),permissions:["authorization:user:view"],index:!0},{path:"/authorization/users/:id/edit",element:l(U),permissions:["authorization:user:update"],index:!0}]},{path:"/authorization/service-accounts",name:"serviceAccounts",icon:e.jsx(S,{}),permissions:["authorization:service_account:view"],children:[{element:l(qe),permissions:["authorization:service_account:view"],index:!0},{path:"/authorization/service-accounts/:id",element:l(Ke),permissions:["authorization:service_account:view"],index:!0}]}]},...x,{name:"system",icon:e.jsx(te,{}),permissions:["system:settings:view","system:settings:update","system:audit:view"],children:[{path:"/system/settings",icon:e.jsx(Z,{}),index:!0,name:"settings",permissions:["system:settings:view","system:settings:update"],element:l(Ue,{transformItems:o})},{path:"/system/audit",icon:e.jsx(ee,{}),name:"audit",permissions:["system:audit:view"],index:!0,element:l(Me)}]},{path:"*",element:l(F),index:!0}]}];return[...m,...p]},Ge={authorization:Pe,base:$e,system:De,oauth:Oe},{Header:We,Content:Ye,Footer:Je,Sider:Xe}=O,{SubMenu:Ze}=P,et=({element:o,routes:d,transformLangConfig:x,menuStyle:g="dark"})=>{const{t:m,i18n:p}=V(),{t:u}=V("common"),[j,A]=n.useState(!1),_=ae(),{hasPermission:I}=we(),y=ne(),{logout:z,user:i}=be(),[s,E]=n.useState([]),[R,L]=n.useState(null),[$,q]=n.useState("Loading..."),[f,K]=n.useState(null);_.pathname!=="/profile"&&(i&&i.mfa_enforced&&!i.mfa_enabled?y("/profile#mfa"):i&&i.status==="password_expired"&&y("/profile#password"));const Q=()=>{z(),window.location.href=M("/login?redirect="+encodeURIComponent(window.location.href))},G=[{key:"profile",label:e.jsx(b,{to:"/profile",children:u("profile")})},{key:"logout",label:u("logout"),onClick:Q}];n.useEffect(()=>{Ge.system.getSiteConfig().then(a=>{var t;const r=a.navigation.filter(h=>h.path!==a.home_page),v=[...a.home_page?[{name:"home",path:a.home_page}]:[],...r];v.length>1?E(v):E([]),L(a.logo),K(a),(t=document.getElementById("site-icon"))==null||t.setAttribute("href",a.logo)})},[]),n.useEffect(()=>{p.language&&q((f==null?void 0:f.name_i18n[p.language])||(f==null?void 0:f.name)||"")},[f,p.language]);const D=()=>{const a=de(d,_.pathname),r=[];if(a){for(const[v,t]of a.entries())if(t.route.path==="/"&&!t.route.name)r.push({href:t.route.path,title:u("home"),key:"home"});else if(t.route.name){const h=a.slice(0,v+1).map(w=>w.route.name).filter(Boolean).join(".");r.push({path:t.route.path,title:t.route.name?m(`breadcrumbs.${h}`):void 0,key:t.route.path})}}return r},W=a=>a.some(r=>I(r)),Y=ie.flatMapDeep(d,a=>a.children).map(a=>a==null?void 0:a.name).filter(a=>a!==void 0),k=(a,r=[])=>{const v=t=>t&&t.replace(/_/g," ").split(" ").map(h=>h.charAt(0).toUpperCase()+h.slice(1)).join(" ");return a.flatMap(t=>"children"in t&&t.children&&!t.name?t.children:[t]).map(t=>{if(t.permissions&&!W(t.permissions))return null;const h=v(t.name);if(!t.name)return null;if("children"in t&&t.children){const w=k(t.children,[...r,t.name]);return w.length==0&&t.path?e.jsx(P.Item,{icon:t.icon,children:e.jsx(b,{to:t.path,children:m(`menu.${[...r,t.name].join(".")}`,{defaultValue:h})})},t.path):e.jsx(Ze,{icon:t.icon,title:m(`menu.${[...r,t.name,t.name].join(".")}`,{defaultValue:h}),children:w},t.path??t.name)}return t.name&&t.path?e.jsx(P.Item,{icon:t.icon,children:e.jsx(b,{to:t.path,children:m(`menu.${[...r,t.name].join(".")}`,{defaultValue:h})})},t.path):null}).filter(Boolean)};return n.useEffect(()=>{const a=D().filter(r=>r.path!=="/").map(r=>r.title).join(" - ");a?document.title=`${$} | ${a}`:document.title=$},[D,_.pathname]),e.jsxs(O,{style:{minHeight:"100vh"},children:[e.jsxs(Xe,{collapsible:!0,collapsed:j,onCollapse:A,theme:g,children:[e.jsx("div",{className:"logo",style:{margin:"8px",display:"flex"},children:e.jsx("div",{style:{width:"100%",height:"100%",textAlign:"center"},children:R?e.jsx("img",{src:R,alt:"logo",style:{height:"32px",width:"32px"}}):e.jsx(se,{size:"large",tip:"Loading..."})})}),e.jsx(P,{theme:g,defaultOpenKeys:Y,defaultSelectedKeys:["1"],mode:"inline",selectedKeys:[_.pathname],children:k(d)})]}),e.jsxs(O,{className:"site-layout",children:[e.jsxs(We,{className:"site-layout-background",style:{padding:0,display:"flex",justifyContent:"space-between"},children:[e.jsx(oe,{type:"text",icon:j?e.jsx(re,{}):e.jsx(le,{}),onClick:()=>A(!j),style:{fontSize:"16px",width:64,height:64}}),e.jsxs("div",{style:{marginRight:"20px"},children:[e.jsx(B,{hidden:s.length<=1,menu:{items:s.map(a=>({key:a.path,style:{paddingRight:"20px"},label:e.jsx("a",{href:a.path,children:m(`menu.${a.name}`,{defaultValue:a.name})})}))},children:e.jsx(ce,{})}),e.jsxs(B,{menu:{items:G},children:[i!=null&&i.avatar?e.jsx(C,{src:i.avatar}):e.jsx(C,{icon:e.jsx(S,{})}),e.jsx("span",{style:{height:"1em",lineHeight:"1em"},children:(i==null?void 0:i.full_name)||(i==null?void 0:i.username)})]}),e.jsx(Ie,{transformLangConfig:x})]})]}),e.jsxs(Ye,{style:{margin:"0 16px"},children:[e.jsx(ue,{style:{margin:"16px 0"},itemRender:a=>{const r=a.href||a.path;return r?e.jsx(b,{to:r,children:a.title}):e.jsx("span",{children:a.title})},items:D()}),e.jsx("div",{className:"site-layout-background",style:{padding:24,minHeight:360},children:o??e.jsx(he,{})})]}),e.jsxs(Je,{style:{textAlign:"center"},children:[" Â©",new Date().getFullYear()," ",$]})]})]})},tt=new me({defaultOptions:{queries:{refetchOnWindowFocus:!1,retry:1}}}),H={"zh-CN":ve,"en-US":T,"de-DE":ge,"es-ES":xe,"fr-FR":fe,"ar-AE":_e,"sv-SE":pe};function at({transformRouter:o=u=>u,transformSettingTabs:d=u=>u,transformLangConfig:x=u=>u,extraPrivateRoutes:g=[],extraPublicRoutes:m=[],menuStyle:p="dark"}){const{i18n:u}=V(),[j,A]=n.useState(H[u.language]||T);n.useEffect(()=>{A(H[u.language]||T)},[u.language]);const _=z=>z.map(i=>i.children===void 0?i:{...i,children:_(i.children)}),I=o(_(Qe({transformSettingTabs:d,transformLangConfig:x,extraPrivateRoutes:g,extraPublicRoutes:m}))),y=(z,i)=>z.flatMap(s=>s.is_private?[s]:"children"in s&&s.children?s.children:[s]).map((s,E)=>{const R=s.is_private?e.jsx(Le,{element:e.jsx(et,{routes:I,element:s.element,transformLangConfig:x,menuStyle:p})}):s.element;if("children"in s&&s.children&&s.children.length>0)return e.jsx(N,{path:s.path,element:R,children:y(s.children,s)},s.path??s.name??E);const{path:L}=s;return e.jsx(N,{path:L,index:s.index,element:R},L??s.name??`${(i==null?void 0:i.path)??""}.${E}`)}).filter(Boolean);return e.jsx(je,{client:tt,children:e.jsx(ye,{locale:j,children:e.jsx(Se,{children:e.jsx(ze,{basename:M(),children:e.jsx(Ee,{children:y(I)})})})})})}Re.createRoot(document.getElementById("root")).render(e.jsx(at,{}));export{Ge as a};
